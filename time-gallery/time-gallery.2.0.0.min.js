'use strict';

var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/**
 *  @Width: 画布宽
 *  @Height: 画布高
 *  @isState: 是否启动 Stage.js 测试FPS, 依赖 stats.js
 *  @isLog: 是否打印数据结构
 *  @isTouch: 是否启动滑动事件
 *  @direction: 可设置水平(horizontal)或垂直(vertical)
 *  @resourcesPath: 图片资源加载的默认路劲
 *  @resources: 图片资源
 *  @sprites: 自定义雪碧图数据数组，方便创建数据的时候可随时调用雪碧图
 *  @data: 创建画布数据
 *  @onInit: 初始化后的回调
 *  @onEnd: 结束后的回调
 *  @onTickStart: 每一帧的开始前回调
 *  @onTickEnd: 每一帧的结束后回调
 *  @onTimeToStart: onTimeTo 开始前回调，可选 TimeGallery 实例作为参数
 *  @onTimeToEnd: onTimeTo 结束后回调，可选 TimeGallery 实例作为参数
 *  @delayTime: 定义画布始点位置
 *  @activeTime: 定义画布当前的播放的位置（可方便测试）
 *  @endTime: 画布默认结束位置，默认是 endPlayTime 最大值或地图的高度
 *  @playLine: 定义元素播放线，即元素滑动到此位置后就开始执行动画（默认元素在屏幕底部的位置开始执行动画）
 *  @touchSpeed: 定义用户滑动速度，越大，滑动的速度越快
 *  @autoPlay: 是否自动播放
 *  @autoSpeed: 自动播放速度
 *  @autoUpdate: 是否自动更新
 */

var TimeGallery = function () {
    function TimeGallery(options) {
        _classCallCheck(this, TimeGallery);

        if (!options.id) return console.error('Canvas id not exist');

        this._stage = new createjs.Stage(document.getElementById(options.id));

        this._loadQueue = null;
        this._isLoading = false;
        this._isEnd = false;
        this._isState = options.isState || false;
        this._isLog = options.isLog || false;
        this._isTouch = options.isTouch !== false;

        this._dirGroup = {
            horizontal: 'horizontal',
            vertical: 'vertical'
        };

        // 定义时间轴的方向
        this._isVertical = (options.direction || this._dirGroup.vertical) === this._dirGroup.vertical;

        // 定义时间轴对象
        this._timeline = null;

        // 定义时间轴延迟时间
        this._delayTime = options.delayTime || 0;

        // 定义时间轴结束的位置
        // 渲染完成后即获取动画组的动画长度与画布长度之间的最大值
        this._endTime = options.endTime || 0;

        // 定义时间轴开始的位置
        this._activeTime = options.activeTime || 0;

        // 定义是否自动播放
        this._autoPlay = options.autoPlay || false;

        // 创建的数据对象
        this._data = options.data || [];

        // 数据实例化对象组
        this._objects = {};

        // 执行动画的数组
        this._animatorsGroup = [];

        // 定义资源默认路劲
        this._resourcesPath = options.resourcesPath || '';

        // 定义资源列表
        this._resources = options.resources || [];
        this._sprites = options.sprites || {};

        // Touch 初始值
        this._touchData = {
            touchstart: 0, // TouchStart 初始 Y 位置
            touchmove: 0, // TouchMove  初始 Y 距离
            friction: 0.92, // 摩擦值
            speed: options.touchSpeed || 1, // Touch 滑动速度
            isInertance: false // 惯性
        };

        this.width = options.width || window.innerWidth;
        this.height = options.height || (this.width ? window.innerHeight / window.innerWidth * this.width : window.innerHeight);
        this.canvas = this._stage.canvas;
        this.canvas.width = this.width;
        this.canvas.height = this.height;

        this.onInit = options.onInit || null;
        this.onEnd = options.onEnd || null;
        this.onTickStart = options.onTickStart || null;
        this.onTickEnd = options.onTickEnd || null;
        this.onTimeToStart = options.onTimeToStart || null;
        this.onTimeToEnd = options.onTimeToEnd || null;

        this.autoSpeed = options.autoSpeed || 1;
        this.autoUpdate = options.autoUpdate || false;

        // 定义动画播放线
        this.playLine = options.playLine || (this._isVertical ? this.height : this.width);

        if (this._isTouch) this._initTouchEvent();

        this.init();
    }

    // 渲染实例


    _createClass(TimeGallery, [{
        key: 'init',
        value: function init() {
            var _this2 = this;

            this._preload(this._resources, {
                path: this._resourcesPath,
                onComplete: function onComplete() {

                    if (typeof _this2._sprites === 'function') _this2._sprites = _this2._sprites(_this2);

                    if (typeof _this2._data === 'function') _this2._data = _this2._data(_this2);

                    var data = [{
                        id: '_timeline',
                        children: [{
                            id: '_timedata',
                            children: _this2._data
                        }]
                    }];

                    // 渲染图像数据
                    _this2._render(data, null, function (displayObject, obj) {
                        if (displayObject) {
                            if (obj.animation) {
                                displayObject.animation = _this2._createAnimate(displayObject, obj.animation);
                                _this2._animatorsGroup.push(displayObject);
                            }
                        }
                    });

                    _this2._timeline = _this2._objects['_timeline'];

                    if (_this2._isVertical) {
                        _this2._objects['_timedata'].y = _this2._delayTime;
                    } else {
                        _this2._objects['_timedata'].x = _this2._delayTime;
                    }

                    // 获取实例最大时间长度
                    if (!_this2._endTime) {
                        var length = void 0,
                            maxEndPlayTime = void 0;

                        if (_this2._isVertical) {
                            length = _this2._timeline.getBounds().height + _this2._timeline.getBounds().y - _this2.height;
                        } else {
                            length = _this2._timeline.getBounds().width + _this2._timeline.getBounds().x - _this2.width;
                        }

                        maxEndPlayTime = Math.max.apply(Math, _this2._animatorsGroup.map(function (displayObject) {
                            return displayObject.animation.endPlayTime;
                        }));

                        _this2._endTime = Math.max(length, maxEndPlayTime);
                    }

                    // 定义当前时间点
                    if (_this2._activeTime) {
                        if (_this2._activeTime < 0) {
                            _this2._activeTime = 0;
                        } else if (_this2._activeTime > _this2._endTime) {
                            _this2._activeTime = _this2._endTime;
                        }

                        var activeTime = -_this2._activeTime;
                        _this2._isVertical ? _this2._timeline.y = activeTime : _this2._timeline.x = activeTime;
                        _this2._updateAnimators();
                    }

                    _this2._stage.update();

                    // 是否打印 FPS 状态，依赖 state.js
                    if (_this2._isState) _this2._stats();

                    // 初始化成功的回调
                    if (_this2.onInit) _this2.onInit();
                }
            });

            createjs.Ticker.timingMode = createjs.Ticker.RAF;
        }

        // 启动实例

    }, {
        key: 'play',
        value: function play() {
            var _this3 = this;

            if (this._tickEvent) this.stop();

            this._tickEvent = function () {
                return _this3._onTick();
            };

            createjs.Ticker.addEventListener('tick', this._tickEvent);
        }

        // 重新开始

    }, {
        key: 'replay',
        value: function replay() {
            this._touchData.touchstart = 0;
            this._touchData.touchmove = 0;
            this._touchData.isInertance = false;

            if (this._isVertical) {
                this._timeline.y = 0;
            } else {
                this._timeline.x = 0;
            }

            this._animatorsGroup.forEach(function (displayObject) {
                displayObject.animation.set(0);
            });

            this._stage.update();

            this.play();
        }

        // 停止实例

    }, {
        key: 'stop',
        value: function stop() {
            createjs.Ticker.removeEventListener('tick', this._tickEvent);
            this._tickEvent = null;
        }

        // 删除 id 数据，包括 id 的子属性

    }, {
        key: 'remove',
        value: function remove(id) {
            var displayObject = this._objects[id];
            var parent = displayObject.parent;

            parent.removeChild(displayObject);

            this._stage.update();
            this._removeObject(id);
        }

        // 摧毁对象，移除所有 Data 对象

    }, {
        key: 'destroy',
        value: function destroy() {
            this.stop();

            this._initTouchData();

            this._stage.removeAllChildren();
            this._stage.update();

            this._objects = {};
            this._animatorsGroup = [];
            this._endTime = 0;
            this._activeTime = 0;
        }

        // 获取当前时间位置

    }, {
        key: 'getActiveTime',
        value: function getActiveTime() {
            return this._activeTime;
        }

        // 获取总时间

    }, {
        key: 'getEndTime',
        value: function getEndTime() {
            return this._endTime;
        }

        // 获取 Data 对象信息

    }, {
        key: 'getObject',
        value: function getObject() {
            var id = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';


            if (id === '') return this._objects;

            var displayObject = this._objects[id];

            if (displayObject === undefined) return null;

            var width = displayObject.width,
                height = displayObject.height,
                regX = displayObject.regX,
                regY = displayObject.regY,
                rotation = displayObject.rotation,
                scaleX = displayObject.scaleX,
                scaleY = displayObject.scaleY,
                skewX = displayObject.skewX,
                skewY = displayObject.skewY,
                alpha = displayObject.alpha,
                type = displayObject.type,
                x = displayObject.x,
                y = displayObject.y,
                visible = displayObject.visible;

            var object = {
                id: id,
                width: width,
                height: height,
                regX: regX,
                regY: regY,
                rotation: rotation,
                scaleX: scaleX,
                scaleY: scaleY,
                skewX: skewX,
                skewY: skewY,
                alpha: alpha,
                type: type,
                x: x,
                y: y,
                visible: visible,
                target: displayObject
            };

            if (this._isVertical) {
                object.y = this._getObjectTime(displayObject);
            } else {
                object.x = this._getObjectTime(displayObject);
            }

            if (displayObject.animation) {
                object.animation = displayObject.animation;
            }

            return object;
        }

        // 获取图片资源信息

    }, {
        key: 'getImage',
        value: function getImage() {
            var id = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';


            if (id === '') return this._loadQueue;

            return this._loadQueue[id];
        }
    }, {
        key: 'getSprite',
        value: function getSprite() {
            var id = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';


            if (id === '') return this._sprites;

            return this._sprites[id];
        }
    }, {
        key: 'timeTo',
        value: function timeTo(time) {
            var _this4 = this;

            var duration = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
            var callback = arguments[2];


            var timeToPos = 0;

            if (typeof time === 'string') {
                var prefix = time[0];
                switch (prefix) {
                    case '+':
                    case '-':
                        timeToPos = this._activeTime + parseInt(time);
                        break;
                    default:
                        // timeToPos = this._getObjectTime(this._objects[time])
                        return;
                }
            } else if (typeof time === 'number') {
                timeToPos = time;
            } else {
                return;
            }

            if (this._activeTime === timeToPos) return;

            if (this.onTimeToStart) this.onTimeToStart(this);

            if (duration === 0) {

                this._activeTime = timeToPos;

                if (this._isVertical) {
                    this._timeline.y = -this._activeTime;
                } else {
                    this._timeline.x = -this._activeTime;
                }

                this._updateAnimators();

                this._stage.update();

                this._onTimeToEnd(callback);
            } else {

                this.stop();

                var startDate = new Date().getTime();
                var activeDate = 0;
                var timeToDir = 1;
                var timeToStart = 0;
                var timeToMove = 0;
                var timeToProgress = 0;
                var timeToDistance = Math.abs(this._activeTime - timeToPos);

                // 判断滑动方向
                if (this._activeTime > timeToPos) timeToDir = -1;

                // 定义滑动 Ticker 事件
                this._tickEvent = function () {

                    if (_this4.onTickStart) _this4.onTickStart(_this4);

                    activeDate = new Date().getTime();
                    timeToProgress = (activeDate - startDate) / duration;
                    timeToMove = Math.floor(timeToProgress * timeToDistance) * timeToDir;

                    if (timeToMove > timeToDistance) timeToMove = timeToDistance;

                    _this4._activeTime += timeToMove - timeToStart;

                    timeToStart = timeToMove;

                    if (_this4._activeTime < 0) {

                        if (_this4._isVertical) {
                            _this4._activeTime = 0;
                        } else {
                            _this4._activeTime = 0;
                        }

                        _this4._onTimeToEnd(callback);
                    } else if (_this4._activeTime >= _this4._endTime) {

                        _this4._activeTime = _this4._endTime;

                        _this4._onTimeToEnd(callback);

                        _this4._isEnd = true;

                        if (_this4.onEnd) _this4.onEnd();
                    } else if (timeToProgress >= 1) {
                        _this4._onTimeToEnd(callback);
                    }

                    if (_this4._isVertical) {
                        _this4._timeline.y = -_this4._activeTime;
                    } else {
                        _this4._timeline.x = -_this4._activeTime;
                    }

                    _this4._updateAnimators();

                    if (_this4.onTickEnd) _this4.onTickEnd(_this4);

                    _this4._stage.update();
                };

                createjs.Ticker.addEventListener('tick', this._tickEvent);
            }
        }
    }, {
        key: '_onTimeToEnd',
        value: function _onTimeToEnd(callback) {
            if (this._touchData.touchmove !== 0) this._initTouchData();
            if (this.onTimeToEnd) this.onTimeToEnd(this);
            if (callback) callback(this);
            this.play();
        }
    }, {
        key: '_onTick',
        value: function _onTick() {
            if (!this._isLoading && this._timeline) {

                if (this.autoUpdate && this.onTickStart) this.onTickStart(this);

                if (this._autoPlay || this._touchData.isMoving) {

                    if (!this.autoUpdate && this.onTickStart) this.onTickStart(this);

                    var activeTime = void 0;

                    if (this._touchData.isMoving) {

                        // 如果是惯性
                        if (this._touchData.isInertance) {
                            // 惯性减速
                            this._touchData.touchmove *= this._touchData.friction;

                            if (Math.abs(this._touchData.touchmove) <= 1) this._initTouchData();
                        }

                        // 根据滑动的位置记录动画执行
                        if (this._isVertical) {
                            this._timeline.y += this._touchData.touchmove * this._touchData.speed;
                            activeTime = -this._timeline.y;
                        } else {
                            this._timeline.x += this._touchData.touchmove * this._touchData.speed;
                            activeTime = -this._timeline.x;
                        }

                        this._updateTime(activeTime);
                    } else {

                        if (this._isVertical) {
                            this._timeline.y -= this.autoSpeed;
                            activeTime = -this._timeline.y;
                        } else {
                            this._timeline.x -= this.autoSpeed;
                            activeTime = -this._timeline.x;
                        }

                        this._updateTime(activeTime);
                    }

                    if (this.onTickEnd) this.onTickEnd(this);

                    if (!this.autoUpdate) this._stage.update();
                }

                if (this.autoUpdate) this._stage.update();

                if (this._isState) this.stats.update();
            }
        }
    }, {
        key: '_updateTime',
        value: function _updateTime(activeTime) {

            if (activeTime < this._endTime) {
                this._isEnd = false;
            }

            if (activeTime < 0) {

                activeTime = 0;

                if (this._isVertical) {
                    this._timeline.y = 0;
                } else {
                    this._timeline.x = 0;
                }
            } else if (activeTime > this._endTime) {

                activeTime = this._endTime;

                if (this._isVertical) {
                    this._timeline.y = -this._endTime;
                } else {
                    this._timeline.x = -this._endTime;
                }

                if (this._isEnd) return;

                this._isEnd = true;

                if (this.onEnd) this.onEnd();
            }

            this._activeTime = activeTime;

            this._updateAnimators();
        }
    }, {
        key: '_updateAnimators',
        value: function _updateAnimators() {
            var pos = this._isVertical ? -this._timeline.y : -this._timeline.x;

            this._animatorsGroup.map(function (displayObject) {
                var startPlayTime = displayObject.animation.startPlayTime;
                var endPlayTime = displayObject.animation.endPlayTime;

                if (pos >= startPlayTime && pos < endPlayTime) {
                    displayObject.animation.update(Math.abs(pos - startPlayTime));
                } else if (pos < startPlayTime) {
                    displayObject.animation.set(0);
                } else if (pos >= endPlayTime) {
                    displayObject.animation.set(endPlayTime - startPlayTime);
                }
            });

            if (this.onTickEnd) this.onTickEnd(this);
        }
    }, {
        key: '_preload',
        value: function _preload() {
            var _this5 = this;

            var manifest = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];

            var _ref = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},
                _ref$onComplete = _ref.onComplete,
                onComplete = _ref$onComplete === undefined ? function () {} : _ref$onComplete,
                _ref$onProgress = _ref.onProgress,
                onProgress = _ref$onProgress === undefined ? function () {} : _ref$onProgress,
                _ref$path = _ref.path,
                path = _ref$path === undefined ? '' : _ref$path;

            this._isLoading = true;

            var fileList = null;

            if (Array.isArray(manifest)) {
                if (manifest.length === 0) return;
                fileList = manifest;
            } else if (typeof manifest === 'string') {
                fileList = [{
                    src: manifest,
                    id: manifest
                }];
            } else if ((typeof manifest === 'undefined' ? 'undefined' : _typeof(manifest)) === 'object') {
                if (!manifest.id) {
                    manifest.id = manifest.src;
                }
                fileList = [manifest];
            } else {
                return false;
            }

            var loadedNumber = 0;
            var preloadNumber = fileList.length;
            var images = {};

            var _loop = function _loop(i) {
                var image = new Image();
                var file = fileList[i];
                var fileType = typeof file === 'undefined' ? 'undefined' : _typeof(file);
                var src = '';

                if (fileType === 'object') {
                    src = file.src;
                } else if (fileType === 'string') {
                    src = file;
                }

                image.src = path + src;
                image.onload = function () {

                    if (file.id) {
                        images[file.id] = image;
                    } else {
                        images[src] = image;
                    }

                    loadedNumber++;

                    var progress = Math.floor(loadedNumber / preloadNumber * 100);

                    onProgress(progress);

                    if (progress >= 100) {
                        _this5._isLoading = false;
                        _this5._loadQueue = images;
                        onComplete();
                    }
                };
            };

            for (var i = 0; i < preloadNumber; i++) {
                _loop(i);
            }

            // 基于 PreloadJs
            // this._loadQueue = new createjs.LoadQueue(true, path);
            //
            // if (progress) this._loadQueue.on('progress', e => onProgress(e));
            //
            // this._loadQueue.on('complete', e => {
            //     this._isLoading = false;
            //     if (onComplete) onComplete(e);
            // });
            //
            // this._loadQueue.loadManifest(loadManifest);
        }
    }, {
        key: '_addObject',
        value: function _addObject() {
            var obj = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};


            var displayObject = null;

            switch (obj.type) {
                case 'shape':

                    displayObject = new createjs.Shape();

                    var _iteratorNormalCompletion = true;
                    var _didIteratorError = false;
                    var _iteratorError = undefined;

                    try {
                        for (var _iterator = Object.keys(obj.graphics)[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
                            var key = _step.value;

                            if (Array.isArray(obj.graphics[key])) {
                                var _displayObject$graphi;

                                (_displayObject$graphi = displayObject.graphics)[key].apply(_displayObject$graphi, _toConsumableArray(obj.graphics[key]));
                            } else if (obj.graphics[key] instanceof Object) {
                                displayObject.graphics[key](obj.graphics[key]);
                            } else {
                                displayObject.graphics[key](obj.graphics[key]);
                            }
                        }
                    } catch (err) {
                        _didIteratorError = true;
                        _iteratorError = err;
                    } finally {
                        try {
                            if (!_iteratorNormalCompletion && _iterator.return) {
                                _iterator.return();
                            }
                        } finally {
                            if (_didIteratorError) {
                                throw _iteratorError;
                            }
                        }
                    }

                    break;
                case 'bitmap':
                    if (obj.image) {
                        displayObject = new createjs.Bitmap(obj.image);
                    }
                    break;
                case 'text':
                    displayObject = new createjs.Text();
                    break;
                case 'sprite':
                    if (obj.sheet) {
                        var spriteSheet = new createjs.SpriteSheet(obj.sheet);
                        displayObject = new createjs.Sprite(spriteSheet);
                    }
                    break;
                default:
                    displayObject = new createjs.Container();
                    break;
            }

            if (obj.type) {
                displayObject.type = obj.type;
            } else {
                displayObject.type = 'container';
            }

            if (obj.id) displayObject.name = obj.id;

            if (obj.parent_id) displayObject.parentId = obj.parent_id;

            if (obj.prop) {
                var _iteratorNormalCompletion2 = true;
                var _didIteratorError2 = false;
                var _iteratorError2 = undefined;

                try {
                    for (var _iterator2 = Object.keys(obj.prop)[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {
                        var propKey = _step2.value;

                        // 判断属性类型
                        if (displayObject[propKey] instanceof Object) {
                            var _iteratorNormalCompletion3 = true;
                            var _didIteratorError3 = false;
                            var _iteratorError3 = undefined;

                            try {
                                for (var _iterator3 = Object.keys(obj.prop[propKey])[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {
                                    var _key = _step3.value;

                                    if (typeof displayObject[propKey][_key] === 'function') {
                                        var _displayObject$propKe;

                                        (_displayObject$propKe = displayObject[propKey])[_key].apply(_displayObject$propKe, _toConsumableArray(obj.prop[propKey][_key]));
                                    } else {
                                        displayObject[propKey][_key] = obj.prop[propKey][_key];
                                    }
                                }
                            } catch (err) {
                                _didIteratorError3 = true;
                                _iteratorError3 = err;
                            } finally {
                                try {
                                    if (!_iteratorNormalCompletion3 && _iterator3.return) {
                                        _iterator3.return();
                                    }
                                } finally {
                                    if (_didIteratorError3) {
                                        throw _iteratorError3;
                                    }
                                }
                            }
                        } else if (typeof displayObject[propKey] === 'function') {
                            var _displayObject;

                            (_displayObject = displayObject)[propKey].apply(_displayObject, _toConsumableArray(obj.prop[propKey]));
                        } else {
                            displayObject[propKey] = obj.prop[propKey];
                        }
                    }
                } catch (err) {
                    _didIteratorError2 = true;
                    _iteratorError2 = err;
                } finally {
                    try {
                        if (!_iteratorNormalCompletion2 && _iterator2.return) {
                            _iterator2.return();
                        }
                    } finally {
                        if (_didIteratorError2) {
                            throw _iteratorError2;
                        }
                    }
                }

                if (obj.type === 'text' && obj.prop.align) {
                    switch (obj.prop.align) {
                        case 'center':
                            displayObject.x = (this.width - displayObject.getBounds().width) / 2;
                            break;
                        case 'right':
                            displayObject.x = this.width - displayObject.getBounds().width;
                            break;
                        default:
                            displayObject.x = 0;
                    }
                }
            }

            if (obj.method) {
                var _iteratorNormalCompletion4 = true;
                var _didIteratorError4 = false;
                var _iteratorError4 = undefined;

                try {
                    for (var _iterator4 = Object.keys(obj.method)[Symbol.iterator](), _step4; !(_iteratorNormalCompletion4 = (_step4 = _iterator4.next()).done); _iteratorNormalCompletion4 = true) {
                        var _displayObject2;

                        var _key2 = _step4.value;

                        (_displayObject2 = displayObject)[_key2].apply(_displayObject2, _toConsumableArray(obj.method[_key2]));
                    }
                } catch (err) {
                    _didIteratorError4 = true;
                    _iteratorError4 = err;
                } finally {
                    try {
                        if (!_iteratorNormalCompletion4 && _iterator4.return) {
                            _iterator4.return();
                        }
                    } finally {
                        if (_didIteratorError4) {
                            throw _iteratorError4;
                        }
                    }
                }
            }

            if (obj.event) {
                if (obj.event.handle) {
                    var type = obj.event.type || 'click';
                    displayObject.addEventListener(type, obj.event.handle);
                }
            }

            if (displayObject.getBounds()) {
                var bounds = displayObject.getBounds();
                displayObject.width = bounds.width;
                displayObject.height = bounds.height;
            }

            return displayObject;
        }
    }, {
        key: '_removeObject',
        value: function _removeObject(id) {
            var _this6 = this;

            var displayObject = this._objects[id];

            delete this._objects[id];

            if (displayObject.animation) {
                this._removeAnimator(displayObject.name);
            }

            var children = displayObject.children;

            if (children) {
                children.forEach(function (child) {
                    delete _this6._objects[child.name];
                    if (child.children) {
                        _this6._removeObject(child);
                    }

                    if (child.animation) {
                        _this6._removeAnimator(child.name);
                    }
                });
            }
        }
    }, {
        key: '_removeAnimator',
        value: function _removeAnimator(id) {
            for (var i = 0, len = this._animatorsGroup.length; i < len; i++) {
                if (this._animatorsGroup[i].name === id) {
                    this._animatorsGroup.splice(i, 1);
                    return;
                }
            }
        }
    }, {
        key: '_render',
        value: function _render() {
            var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];

            var _this7 = this;

            var parent_id = arguments[1];
            var custom = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : function () {};


            if (data instanceof Object) {
                data = Array.from(data);
            }

            data.map(function (obj, index) {

                obj.parent_id = parent_id;

                if (obj.id === undefined) obj.id = parent_id + '_' + index;

                if (_this7._objects[obj.id]) {
                    console.error('Data id:\'' + obj.id + '\' is it exists already');
                    return;
                }

                _this7._objects[obj.id] = _this7._addObject(obj);

                if (_this7._isLog) {
                    console.group(obj.id + ':');
                    console.table({
                        x: _this7._objects[obj.id].x,
                        y: _this7._objects[obj.id].y,
                        regX: _this7._objects[obj.id].regX,
                        regY: _this7._objects[obj.id].regY,
                        scaleX: _this7._objects[obj.id].scaleX,
                        scaleY: _this7._objects[obj.id].scaleY,
                        rotation: _this7._objects[obj.id].rotation,
                        alpha: _this7._objects[obj.id].alpha,
                        visible: _this7._objects[obj.id].visible
                    });
                }

                if (parent_id) {
                    _this7._objects[parent_id].addChild(_this7._objects[obj.id]);
                } else {
                    _this7._stage.addChild(_this7._objects[obj.id]);
                }

                // 自定义属性
                if (custom) {
                    custom(_this7._objects[obj.id], obj);
                }

                if (obj.children) {
                    _this7._render(obj.children, obj.id, custom);
                }

                if (_this7._isLog) {
                    console.groupEnd();
                }
            });

            this._stage.update();
        }
    }, {
        key: '_createAnimate',
        value: function _createAnimate(displayObject) {
            var _ref2 = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},
                _ref2$x = _ref2.x,
                x = _ref2$x === undefined ? null : _ref2$x,
                _ref2$y = _ref2.y,
                y = _ref2$y === undefined ? null : _ref2$y,
                _ref2$scaleX = _ref2.scaleX,
                scaleX = _ref2$scaleX === undefined ? null : _ref2$scaleX,
                _ref2$scaleY = _ref2.scaleY,
                scaleY = _ref2$scaleY === undefined ? null : _ref2$scaleY,
                _ref2$skewX = _ref2.skewX,
                skewX = _ref2$skewX === undefined ? null : _ref2$skewX,
                _ref2$skewY = _ref2.skewY,
                skewY = _ref2$skewY === undefined ? null : _ref2$skewY,
                _ref2$rotation = _ref2.rotation,
                rotation = _ref2$rotation === undefined ? null : _ref2$rotation,
                _ref2$alpha = _ref2.alpha,
                alpha = _ref2$alpha === undefined ? 1 : _ref2$alpha,
                _ref2$top = _ref2.top,
                top = _ref2$top === undefined ? 0 : _ref2$top,
                _ref2$delay = _ref2.delay,
                delay = _ref2$delay === undefined ? 0 : _ref2$delay,
                _ref2$duration = _ref2.duration,
                duration = _ref2$duration === undefined ? 0 : _ref2$duration,
                _ref2$sprite = _ref2.sprite,
                sprite = _ref2$sprite === undefined ? [] : _ref2$sprite,
                _ref2$startById = _ref2.startById,
                startById = _ref2$startById === undefined ? null : _ref2$startById,
                _ref2$endById = _ref2.endById,
                endById = _ref2$endById === undefined ? null : _ref2$endById,
                _ref2$afterById = _ref2.afterById,
                afterById = _ref2$afterById === undefined ? null : _ref2$afterById,
                _ref2$musicById = _ref2.musicById,
                musicById = _ref2$musicById === undefined ? null : _ref2$musicById,
                _ref2$musicStopById = _ref2.musicStopById,
                musicStopById = _ref2$musicStopById === undefined ? null : _ref2$musicStopById;

            var mapPos = this._getObjectTime(displayObject) + this._delayTime,
                startX = displayObject.x,
                // 动画 X 开始
            startY = displayObject.y,
                // 动画 Y 开始
            endX = x,
                // 动画 X 结束
            endY = y,
                // 动画 Y 结束
            initAlpha = displayObject.alpha,
                initScaleX = displayObject.scaleX,
                initScaleY = displayObject.scaleY,
                initSkewX = displayObject.skewX,
                initSkewY = displayObject.skewY,
                initRotation = displayObject.rotation,
                isMusic = false,
                isPlay = false,
                music = null,
                musicStop = null;

            var startPlayTime = 0; // 对象开始执行动画位置
            var endPlayTime = 0; // 对象结束执行动画位置

            if (top) {
                delay = -top;
            }

            if (startById) {
                startPlayTime = this._objects[startById].animation.startPlayTime + delay;
            } else if (afterById) {
                startPlayTime = this._objects[afterById].animation.endPlayTime + delay;
            } else if (endById) {
                startPlayTime = this._objects[endById].animation.endPlayTime - duration + delay;
            } else {
                if (mapPos + delay >= this.playLine) {
                    startPlayTime = mapPos + delay - this.playLine;
                } else {
                    startPlayTime = 0;
                }
            }

            if (endById) {
                endPlayTime = this._objects[endById].animation.endPlayTime;
            } else {
                endPlayTime = startPlayTime + duration;
            }

            if (musicById) {
                music = document.getElementById(musicById);
            }

            if (musicStopById) {
                musicStop = document.getElementById(musicStopById);
            }

            function _animate(rate) {
                var progress = rate / duration;

                if (sprite.length > 1) {
                    var length = sprite.length;
                    var durationSegment = duration / length;
                    var currentIndex = Math.min(rate / durationSegment | 0, length - 1);
                    displayObject.image = sprite[currentIndex];
                }

                if (endX || endX === 0) displayObject.x = progress * (endX - startX) + startX;
                if (endY || endY === 0) displayObject.y = progress * (endY - startY) + startY;
                if (scaleX || scaleX === 0) displayObject.scaleX = progress * (scaleX - initScaleX) + initScaleX;
                if (scaleY || scaleY === 0) displayObject.scaleY = progress * (scaleY - initScaleY) + initScaleY;
                if (skewX || skewX === 0) displayObject.skewX = progress * (skewX - initSkewX) + initSkewX;
                if (skewY || skewY === 0) displayObject.skewY = progress * (skewY - initSkewY) + initSkewY;
                if (rotation || rotation === 0) displayObject.rotation = progress * (rotation - initRotation) + initRotation;
                if (alpha || alpha === 0) displayObject.alpha = progress * (alpha - initAlpha) + initAlpha;
            }

            return {
                startPlayTime: startPlayTime,
                endPlayTime: endPlayTime,
                update: function update(rate) {

                    var progress = rate / duration;

                    if ((progress === 0 || progress === 1) && isPlay === false) {
                        return;
                    }

                    if (progress >= 1) {
                        progress = 1;
                        isPlay = false;
                    } else if (progress <= 0) {
                        progress = 0;
                        isPlay = false;
                    } else {
                        isPlay = true;
                    }

                    if (music) {
                        if (isMusic === false) {
                            music.currentTime = 0;
                            music.play();
                            isMusic = true;
                        } else if (isMusic === true && progress === 0) {
                            if (!music.paused) {
                                music.pause();
                                isMusic = false;
                            }
                        }
                    }

                    if (musicStop) {
                        if (!musicStop.paused) musicStop.pause();
                    }

                    _animate(rate);
                },
                set: function set(rate) {
                    if (isPlay) isPlay = false;
                    if (isMusic) isMusic = false;

                    _animate(rate);
                }
            };
        }
    }, {
        key: '_getObjectTime',
        value: function _getObjectTime(displayObject) {
            var sum = this._isVertical ? displayObject.y : displayObject.x;
            var _this = this;

            _countTime(displayObject);

            return sum;

            function _countTime(displayObject) {
                var parent = displayObject.parent;

                if (parent && parent.name !== '_timeline') {
                    sum += _this._isVertical ? parent.y : parent.x;
                    _countTime(parent);
                }
            }
        }

        // 初始化手势

    }, {
        key: '_initTouchEvent',
        value: function _initTouchEvent() {
            var _this8 = this;

            this.canvas.addEventListener('touchstart', function (e) {
                if (_this8._isVertical) {
                    _this8._touchData.touchstart = e.touches[0].clientY;
                } else {
                    _this8._touchData.touchstart = e.touches[0].clientX;
                }

                _this8._touchData.isInertance = false;
                _this8._touchData.isMoving = false;
            });

            this.canvas.addEventListener('touchmove', function (e) {
                if (_this8._isVertical) {
                    _this8._touchData.touchmove = e.touches[0].clientY - _this8._touchData.touchstart;
                    _this8._touchData.touchstart = e.touches[0].clientY;
                } else {
                    _this8._touchData.touchmove = e.touches[0].clientX - _this8._touchData.touchstart;
                    _this8._touchData.touchstart = e.touches[0].clientX;
                }
                _this8._touchData.isMoving = true;
            });

            this.canvas.addEventListener('touchend', function () {
                _this8._touchData.isInertance = true;
            });
        }
    }, {
        key: '_initTouchData',
        value: function _initTouchData() {
            this._touchData.touchstart = 0;
            this._touchData.touchmove = 0;
            this._touchData.isInertance = false;
            this._touchData.isMoving = false;
        }
    }, {
        key: '_stats',
        value: function _stats() {
            this.stats = new Stats();
            this.stats.showPanel(0); // 0: fps, 1: ms, 2: mb, 3+: custom
            document.body.appendChild(this.stats.dom);
        }
    }]);

    return TimeGallery;
}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRpbWUtZ2FsbGVyeS4yLjAuMC5qcyJdLCJuYW1lcyI6WyJUaW1lR2FsbGVyeSIsIm9wdGlvbnMiLCJpZCIsImNvbnNvbGUiLCJlcnJvciIsIl9zdGFnZSIsImNyZWF0ZWpzIiwiU3RhZ2UiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiX2xvYWRRdWV1ZSIsIl9pc0xvYWRpbmciLCJfaXNFbmQiLCJfaXNTdGF0ZSIsImlzU3RhdGUiLCJfaXNMb2ciLCJpc0xvZyIsIl9pc1RvdWNoIiwiaXNUb3VjaCIsIl9kaXJHcm91cCIsImhvcml6b250YWwiLCJ2ZXJ0aWNhbCIsIl9pc1ZlcnRpY2FsIiwiZGlyZWN0aW9uIiwiX3RpbWVsaW5lIiwiX2RlbGF5VGltZSIsImRlbGF5VGltZSIsIl9lbmRUaW1lIiwiZW5kVGltZSIsIl9hY3RpdmVUaW1lIiwiYWN0aXZlVGltZSIsIl9hdXRvUGxheSIsImF1dG9QbGF5IiwiX2RhdGEiLCJkYXRhIiwiX29iamVjdHMiLCJfYW5pbWF0b3JzR3JvdXAiLCJfcmVzb3VyY2VzUGF0aCIsInJlc291cmNlc1BhdGgiLCJfcmVzb3VyY2VzIiwicmVzb3VyY2VzIiwiX3Nwcml0ZXMiLCJzcHJpdGVzIiwiX3RvdWNoRGF0YSIsInRvdWNoc3RhcnQiLCJ0b3VjaG1vdmUiLCJmcmljdGlvbiIsInNwZWVkIiwidG91Y2hTcGVlZCIsImlzSW5lcnRhbmNlIiwid2lkdGgiLCJ3aW5kb3ciLCJpbm5lcldpZHRoIiwiaGVpZ2h0IiwiaW5uZXJIZWlnaHQiLCJjYW52YXMiLCJvbkluaXQiLCJvbkVuZCIsIm9uVGlja1N0YXJ0Iiwib25UaWNrRW5kIiwib25UaW1lVG9TdGFydCIsIm9uVGltZVRvRW5kIiwiYXV0b1NwZWVkIiwiYXV0b1VwZGF0ZSIsInBsYXlMaW5lIiwiX2luaXRUb3VjaEV2ZW50IiwiaW5pdCIsIl9wcmVsb2FkIiwicGF0aCIsIm9uQ29tcGxldGUiLCJjaGlsZHJlbiIsIl9yZW5kZXIiLCJkaXNwbGF5T2JqZWN0Iiwib2JqIiwiYW5pbWF0aW9uIiwiX2NyZWF0ZUFuaW1hdGUiLCJwdXNoIiwieSIsIngiLCJsZW5ndGgiLCJtYXhFbmRQbGF5VGltZSIsImdldEJvdW5kcyIsIk1hdGgiLCJtYXgiLCJhcHBseSIsIm1hcCIsImVuZFBsYXlUaW1lIiwiX3VwZGF0ZUFuaW1hdG9ycyIsInVwZGF0ZSIsIl9zdGF0cyIsIlRpY2tlciIsInRpbWluZ01vZGUiLCJSQUYiLCJfdGlja0V2ZW50Iiwic3RvcCIsIl9vblRpY2siLCJhZGRFdmVudExpc3RlbmVyIiwiZm9yRWFjaCIsInNldCIsInBsYXkiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwicGFyZW50IiwicmVtb3ZlQ2hpbGQiLCJfcmVtb3ZlT2JqZWN0IiwiX2luaXRUb3VjaERhdGEiLCJyZW1vdmVBbGxDaGlsZHJlbiIsInVuZGVmaW5lZCIsInJlZ1giLCJyZWdZIiwicm90YXRpb24iLCJzY2FsZVgiLCJzY2FsZVkiLCJza2V3WCIsInNrZXdZIiwiYWxwaGEiLCJ0eXBlIiwidmlzaWJsZSIsIm9iamVjdCIsInRhcmdldCIsIl9nZXRPYmplY3RUaW1lIiwidGltZSIsImR1cmF0aW9uIiwiY2FsbGJhY2siLCJ0aW1lVG9Qb3MiLCJwcmVmaXgiLCJwYXJzZUludCIsIl9vblRpbWVUb0VuZCIsInN0YXJ0RGF0ZSIsIkRhdGUiLCJnZXRUaW1lIiwiYWN0aXZlRGF0ZSIsInRpbWVUb0RpciIsInRpbWVUb1N0YXJ0IiwidGltZVRvTW92ZSIsInRpbWVUb1Byb2dyZXNzIiwidGltZVRvRGlzdGFuY2UiLCJhYnMiLCJmbG9vciIsImlzTW92aW5nIiwiX3VwZGF0ZVRpbWUiLCJzdGF0cyIsInBvcyIsInN0YXJ0UGxheVRpbWUiLCJtYW5pZmVzdCIsIm9uUHJvZ3Jlc3MiLCJmaWxlTGlzdCIsIkFycmF5IiwiaXNBcnJheSIsInNyYyIsImxvYWRlZE51bWJlciIsInByZWxvYWROdW1iZXIiLCJpbWFnZXMiLCJpIiwiaW1hZ2UiLCJJbWFnZSIsImZpbGUiLCJmaWxlVHlwZSIsIm9ubG9hZCIsInByb2dyZXNzIiwiU2hhcGUiLCJPYmplY3QiLCJrZXlzIiwiZ3JhcGhpY3MiLCJrZXkiLCJCaXRtYXAiLCJUZXh0Iiwic2hlZXQiLCJzcHJpdGVTaGVldCIsIlNwcml0ZVNoZWV0IiwiU3ByaXRlIiwiQ29udGFpbmVyIiwibmFtZSIsInBhcmVudF9pZCIsInBhcmVudElkIiwicHJvcCIsInByb3BLZXkiLCJhbGlnbiIsIm1ldGhvZCIsImV2ZW50IiwiaGFuZGxlIiwiYm91bmRzIiwiX3JlbW92ZUFuaW1hdG9yIiwiY2hpbGQiLCJsZW4iLCJzcGxpY2UiLCJjdXN0b20iLCJmcm9tIiwiaW5kZXgiLCJfYWRkT2JqZWN0IiwiZ3JvdXAiLCJ0YWJsZSIsImFkZENoaWxkIiwiZ3JvdXBFbmQiLCJ0b3AiLCJkZWxheSIsInNwcml0ZSIsInN0YXJ0QnlJZCIsImVuZEJ5SWQiLCJhZnRlckJ5SWQiLCJtdXNpY0J5SWQiLCJtdXNpY1N0b3BCeUlkIiwibWFwUG9zIiwic3RhcnRYIiwic3RhcnRZIiwiZW5kWCIsImVuZFkiLCJpbml0QWxwaGEiLCJpbml0U2NhbGVYIiwiaW5pdFNjYWxlWSIsImluaXRTa2V3WCIsImluaXRTa2V3WSIsImluaXRSb3RhdGlvbiIsImlzTXVzaWMiLCJpc1BsYXkiLCJtdXNpYyIsIm11c2ljU3RvcCIsIl9hbmltYXRlIiwicmF0ZSIsImR1cmF0aW9uU2VnbWVudCIsImN1cnJlbnRJbmRleCIsIm1pbiIsImN1cnJlbnRUaW1lIiwicGF1c2VkIiwicGF1c2UiLCJzdW0iLCJfdGhpcyIsIl9jb3VudFRpbWUiLCJlIiwidG91Y2hlcyIsImNsaWVudFkiLCJjbGllbnRYIiwiU3RhdHMiLCJzaG93UGFuZWwiLCJib2R5IiwiYXBwZW5kQ2hpbGQiLCJkb20iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFBQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0lBMkJNQSxXO0FBRUYseUJBQWFDLE9BQWIsRUFBc0I7QUFBQTs7QUFFbEIsWUFBSSxDQUFDQSxRQUFRQyxFQUFiLEVBQWlCLE9BQU9DLFFB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RCxVQUFMLENBQWdCRSxTQUFoQixHQUE0QixDQUE1QjtBQUNBLGlCQUFLRixVQUFMLENBQWdCTSxXQUFoQixHQUE4QixLQUE5QjtBQUNBLGlCQUFLTixVQUFMLENBQWdCK0YsUUFBaEIsR0FBMkIsS0FBM0I7QUFDSDs7O2lDQUVTO0FBQ04saUJBQUtFLEtBQUwsR0FBYSxJQUFJMkYsS0FBSixFQUFiO0FBQ0EsaUJBQUszRixLQUFMLENBQVc0RixTQUFYLENBQXFCLENBQXJCLEVBRk0sQ0FFbUI7QUFDekJoTyxxQkFBU2lPLElBQVQsQ0FBY0MsV0FBZCxDQUEwQixLQUFLOUYsS0FBTCxDQUFXK0YsR0FBckM7QUFDSCIsImZpbGUiOiJ0aW1lLWdhbGxlcnkuMi4wLjAubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiAgQFdpZHRoOiDnlLvluIPlrr1cbiAqICBASGVpZ2h0OiDnlLvluIPpq5hcbiAqICBAaXNTdGF0ZTog5piv5ZCm5ZCv5YqoIFN0YWdlLmpzIOa1i+ivlUZQUywg5L6d6LWWIHN0YXRzLmpzXG4gKiAgQGlzTG9nOiDmmK/lkKbmiZPljbDmlbDmja7nu5PmnoRcbiAqICBAaXNUb3VjaDog5piv5ZCm5ZCv5Yqo5ruR5Yqo5LqL5Lu2XG4gKiAgQGRpcmVjdGlvbjog5Y+v6K6+572u5rC05bmzKGhvcml6b250YWwp5oiW5Z6C55u0KHZlcnRpY2FsKVxuICogIEByZXNvdXJjZXNQYXRoOiDlm77niYfotYTmupDliqDovb3nmoTpu5jorqTot6/lirJcbiAqICBAcmVzb3VyY2VzOiDlm77niYfotYTmupBcbiAqICBAc3ByaXRlczog6Ieq5a6a5LmJ6Zuq56Kn5Zu+5pWw5o2u5pWw57uE77yM5pa55L6/5Yib5bu65pWw5o2u55qE5pe25YCZ5Y+v6ZqP5pe26LCD55So6Zuq56Kn5Zu+XG4gKiAgQGRhdGE6IOWIm+W7uueUu+W4g+aVsOaNrlxuICogIEBvbkluaXQ6IOWIneWni+WMluWQjueahOWbnuiwg1xuICogIEBvbkVuZDog57uT5p2f5ZCO55qE5Zue6LCDXG4gKiAgQG9uVGlja1N0YXJ0OiDmr4/kuIDluKfnmoTlvIDlp4vliY3lm57osINcbiAqICBAb25UaWNrRW5kOiDmr4/kuIDluKfnmoTnu5PmnZ/lkI7lm57osINcbiAqICBAb25UaW1lVG9TdGFydDogb25UaW1lVG8g5byA5aeL5YmN5Zue6LCD77yM5Y+v6YCJIFRpbWVHYWxsZXJ5IOWunuS+i+S9nOS4uuWPguaVsFxuICogIEBvblRpbWVUb0VuZDogb25UaW1lVG8g57uT5p2f5ZCO5Zue6LCD77yM5Y+v6YCJIFRpbWVHYWxsZXJ5IOWunuS+i+S9nOS4uuWPguaVsFxuICogIEBkZWxheVRpbWU6IOWumuS5ieeUu+W4g+Wni+eCueS9jee9rlxuICogIEBhY3RpdmVUaW1lOiDlrprkuYnnlLvluIPlvZPliY3nmoTmkq3mlL7nmoTkvY3nva7vvIjlj6/mlrnkvr/mtYvor5XvvIlcbiAqICBAZW5kVGltZTog55S75biD6buY6K6k57uT5p2f5L2N572u77yM6buY6K6k5pivIGVuZFBsYXlUaW1lIOacgOWkp+WAvOaIluWcsOWbvueahOmrmOW6plxuICogIEBwbGF5TGluZTog5a6a5LmJ5YWD57Sg5pKt5pS+57q/77yM5Y2z5YWD57Sg5ruR5Yqo5Yiw5q2k5L2N572u5ZCO5bCx5byA5aeL5omn6KGM5Yqo55S777yI6buY6K6k5YWD57Sg5Zyo5bGP5bmV5bqV6YOo55qE5L2N572u5byA5aeL5omn6KGM5Yqo55S777yJXG4gKiAgQHRvdWNoU3BlZWQ6IOWumuS5ieeUqOaIt+a7keWKqOmAn+W6pu+8jOi2iuWkp++8jOa7keWKqOeahOmAn+W6pui2iuW/q1xuICogIEBhdXRvUGxheTog5piv5ZCm6Ieq5Yqo5pKt5pS+XG4gKiAgQGF1dG9TcGVlZDog6Ieq5Yqo5pKt5pS+6YCf5bqmXG4gKiAgQGF1dG9VcGRhdGU6IOaYr+WQpuiHquWKqOabtOaWsFxuICovXG5cbmNsYXNzIFRpbWVHYWxsZXJ5IHtcblxuICAgIGNvbnN0cnVjdG9yIChvcHRpb25zKSB7XG5cbiAgICAgICAgaWYgKCFvcHRpb25zLmlkKSByZXR1cm4gY29uc29sZS5lcnJvcignQ2FudmFzIGlkIG5vdCBleGlzdCcpO1xuXG4gICAgICAgIHRoaXMuX3N0YWdlID0gbmV3IGNyZWF0ZWpzLlN0YWdlKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKG9wdGlvbnMuaWQpKTtcblxuICAgICAgICB0aGlzLl9sb2FkUXVldWUgPSBudWxsO1xuICAgICAgICB0aGlzLl9pc0xvYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5faXNFbmQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5faXNTdGF0ZSA9IG9wdGlvbnMuaXNTdGF0ZSB8fCBmYWxzZTtcbiAgICAgICAgdGhpcy5faXNMb2cgPSBvcHRpb25zLmlzTG9nIHx8IGZhbHNlO1xuICAgICAgICB0aGlzLl9pc1RvdWNoID0gb3B0aW9ucy5pc1RvdWNoICE9PSBmYWxzZTtcblxuICAgICAgICB0aGlzLl9kaXJHcm91cCA9IHtcbiAgICAgICAgICAgIGhvcml6b250YWw6ICdob3Jpem9udGFsJyxcbiAgICAgICAgICAgIHZlcnRpY2FsOiAndmVydGljYWwnXG4gICAgICAgIH07XG5cbiAgICAgICAgLy8g5a6a5LmJ5pe26Ze06L2055qE5pa55ZCRXG4gICAgICAgIHRoaXMuX2lzVmVydGljYWwgPSAob3B0aW9ucy5kaXJlY3Rpb24gfHwgdGhpcy5fZGlyR3JvdXAudmVydGljYWwpID09PSB0aGlzLl9kaXJHcm91cC52ZXJ0aWNhbDtcblxuICAgICAgICAvLyDlrprkuYnml7bpl7TovbTlr7nosaFcbiAgICAgICAgdGhpcy5fdGltZWxpbmUgPSBudWxsO1xuXG4gICAgICAgIC8vIOWumuS5ieaXtumXtOi9tOW7tui/n+aXtumXtFxuICAgICAgICB0aGlzLl9kZWxheVRpbWUgPSBvcHRpb25zLmRlbGF5VGltZSB8fCAwO1xuXG4gICAgICAgIC8vIOWumuS5ieaXtumXtOi9tOe7k+adn+eahOS9jee9rlxuICAgICAgICAvLyDmuLLmn5PlrozmiJDlkI7ljbPojrflj5bliqjnlLvnu4TnmoTliqjnlLvplb/luqbkuI7nlLvluIPplb/luqbkuYvpl7TnmoTmnIDlpKflgLxcbiAgICAgICAgdGhpcy5fZW5kVGltZSA9IG9wdGlvbnMuZW5kVGltZSB8fCAwO1xuXG4gICAgICAgIC8vIOWumuS5ieaXtumXtOi9tOW8gOWni+eahOS9jee9rlxuICAgICAgICB0aGlzLl9hY3RpdmVUaW1lID0gb3B0aW9ucy5hY3RpdmVUaW1lIHx8IDA7XG5cbiAgICAgICAgLy8g5a6a5LmJ5piv5ZCm6Ieq5Yqo5pKt5pS+XG4gICAgICAgIHRoaXMuX2F1dG9QbGF5ID0gb3B0aW9ucy5hdXRvUGxheSB8fCBmYWxzZTtcblxuICAgICAgICAvLyDliJvlu7rnmoTmlbDmja7lr7nosaFcbiAgICAgICAgdGhpcy5fZGF0YSA9IG9wdGlvbnMuZGF0YSB8fCBbXTtcblxuICAgICAgICAvLyDmlbDmja7lrp7kvovljJblr7nosaHnu4RcbiAgICAgICAgdGhpcy5fb2JqZWN0cyA9IHt9O1xuXG4gICAgICAgIC8vIOaJp+ihjOWKqOeUu+eahOaVsOe7hFxuICAgICAgICB0aGlzLl9hbmltYXRvcnNHcm91cCA9IFtdO1xuXG4gICAgICAgIC8vIOWumuS5iei1hOa6kOm7mOiupOi3r+WKslxuICAgICAgICB0aGlzLl9yZXNvdXJjZXNQYXRoID0gb3B0aW9ucy5yZXNvdXJjZXNQYXRoIHx8ICcnO1xuXG4gICAgICAgIC8vIOWumuS5iei1hOa6kOWIl+ihqFxuICAgICAgICB0aGlzLl9yZXNvdXJjZXMgPSBvcHRpb25zLnJlc291cmNlcyB8fCBbXTtcbiAgICAgICAgdGhpcy5fc3ByaXRlcyA9IG9wdGlvbnMuc3ByaXRlcyB8fCB7fTtcblxuICAgICAgICAvLyBUb3VjaCDliJ3lp4vlgLxcbiAgICAgICAgdGhpcy5fdG91Y2hEYXRhID0ge1xuICAgICAgICAgICAgdG91Y2hzdGFydDogMCxcdFx0XHQgICAgICAgICAgIC8vIFRvdWNoU3RhcnQg5Yid5aeLIFkg5L2N572uXG4gICAgICAgICAgICB0b3VjaG1vdmU6IDAsICAgICAgICAgICAgICAgICAgICAgIC8vIFRvdWNoTW92ZSAg5Yid5aeLIFkg6Led56a7XG4gICAgICAgICAgICBmcmljdGlvbiA6IDAuOTIsXHRcdCAgICAgICAgICAgLy8g5pGp5pOm5YC8XG4gICAgICAgICAgICBzcGVlZDogb3B0aW9ucy50b3VjaFNwZWVkIHx8IDEsICAgIC8vIFRvdWNoIOa7keWKqOmAn+W6plxuICAgICAgICAgICAgaXNJbmVydGFuY2U6IGZhbHNlICAgICAgICAgICAgICAgICAvLyDmg6/mgKdcbiAgICAgICAgfTtcblxuICAgICAgICB0aGlzLndpZHRoID0gb3B0aW9ucy53aWR0aCB8fCB3aW5kb3cuaW5uZXJXaWR0aDtcbiAgICAgICAgdGhpcy5oZWlnaHQgPSBvcHRpb25zLmhlaWdodCB8fCAodGhpcy53aWR0aD8gKHdpbmRvdy5pbm5lckhlaWdodC93aW5kb3cuaW5uZXJXaWR0aCAqIHRoaXMud2lkdGgpIDogd2luZG93LmlubmVySGVpZ2h0KTtcbiAgICAgICAgdGhpcy5jYW52YXMgPSB0aGlzLl9zdGFnZS5jYW52YXM7XG4gICAgICAgIHRoaXMuY2FudmFzLndpZHRoID0gdGhpcy53aWR0aDtcbiAgICAgICAgdGhpcy5jYW52YXMuaGVpZ2h0ID0gdGhpcy5oZWlnaHQ7XG5cbiAgICAgICAgdGhpcy5vbkluaXQgPSBvcHRpb25zLm9uSW5pdCB8fCBudWxsO1xuICAgICAgICB0aGlzLm9uRW5kID0gb3B0aW9ucy5vbkVuZCB8fCBudWxsO1xuICAgICAgICB0aGlzLm9uVGlja1N0YXJ0ID0gb3B0aW9ucy5vblRpY2tTdGFydCB8fCBudWxsO1xuICAgICAgICB0aGlzLm9uVGlja0VuZCA9IG9wdGlvbnMub25UaWNrRW5kIHx8IG51bGw7XG4gICAgICAgIHRoaXMub25UaW1lVG9TdGFydCA9IG9wdGlvbnMub25UaW1lVG9TdGFydCB8fCBudWxsO1xuICAgICAgICB0aGlzLm9uVGltZVRvRW5kID0gb3B0aW9ucy5vblRpbWVUb0VuZCB8fCBudWxsO1xuXG4gICAgICAgIHRoaXMuYXV0b1NwZWVkID0gb3B0aW9ucy5hdXRvU3BlZWQgfHwgMTtcbiAgICAgICAgdGhpcy5hdXRvVXBkYXRlID0gb3B0aW9ucy5hdXRvVXBkYXRlIHx8IGZhbHNlO1xuXG4gICAgICAgIC8vIOWumuS5ieWKqOeUu+aSreaUvue6v1xuICAgICAgICB0aGlzLnBsYXlMaW5lID0gb3B0aW9ucy5wbGF5TGluZSB8fCAodGhpcy5faXNWZXJ0aWNhbD8gdGhpcy5oZWlnaHQgOiB0aGlzLndpZHRoKTtcblxuICAgICAgICBpZiAodGhpcy5faXNUb3VjaCkgdGhpcy5faW5pdFRvdWNoRXZlbnQoKTtcblxuICAgICAgICB0aGlzLmluaXQoKTtcbiAgICB9XG5cbiAgICAvLyDmuLLmn5Plrp7kvotcbiAgICBpbml0KCkge1xuICAgICAgICB0aGlzLl9wcmVsb2FkKHRoaXMuX3Jlc291cmNlcywge1xuICAgICAgICAgICAgcGF0aDogdGhpcy5fcmVzb3VyY2VzUGF0aCxcbiAgICAgICAgICAgIG9uQ29tcGxldGU6ICgpID0+IHtcblxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdGhpcy5fc3ByaXRlcyA9PT0gJ2Z1bmN0aW9uJykgdGhpcy5fc3ByaXRlcyA9IHRoaXMuX3Nwcml0ZXModGhpcyk7XG5cbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHRoaXMuX2RhdGEgPT09ICdmdW5jdGlvbicpIHRoaXMuX2RhdGEgPSB0aGlzLl9kYXRhKHRoaXMpO1xuXG4gICAgICAgICAgICAgICAgY29uc3QgZGF0YSA9IFtcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWQ6ICdfdGltZWxpbmUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGRyZW46IFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiAnX3RpbWVkYXRhJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGRyZW46IHRoaXMuX2RhdGFcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBdO1xuXG4gICAgICAgICAgICAgICAgLy8g5riy5p+T5Zu+5YOP5pWw5o2uXG4gICAgICAgICAgICAgICAgdGhpcy5fcmVuZGVyKGRhdGEsIG51bGwsIChkaXNwbGF5T2JqZWN0LCBvYmopID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRpc3BsYXlPYmplY3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvYmouYW5pbWF0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheU9iamVjdC5hbmltYXRpb24gPSB0aGlzLl9jcmVhdGVBbmltYXRlKGRpc3BsYXlPYmplY3QsIG9iai5hbmltYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2FuaW1hdG9yc0dyb3VwLnB1c2goZGlzcGxheU9iamVjdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHRoaXMuX3RpbWVsaW5lID0gdGhpcy5fb2JqZWN0c1snX3RpbWVsaW5lJ107XG5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5faXNWZXJ0aWNhbCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9vYmplY3RzWydfdGltZWRhdGEnXS55ID0gdGhpcy5fZGVsYXlUaW1lO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX29iamVjdHNbJ190aW1lZGF0YSddLnggPSB0aGlzLl9kZWxheVRpbWU7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8g6I635Y+W5a6e5L6L5pyA5aSn5pe26Ze06ZW/5bqmXG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLl9lbmRUaW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBsZW5ndGgsIG1heEVuZFBsYXlUaW1lO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9pc1ZlcnRpY2FsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZW5ndGggPSB0aGlzLl90aW1lbGluZS5nZXRCb3VuZHMoKS5oZWlnaHQgKyB0aGlzLl90aW1lbGluZS5nZXRCb3VuZHMoKS55IC0gdGhpcy5oZWlnaHQ7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZW5ndGggPSB0aGlzLl90aW1lbGluZS5nZXRCb3VuZHMoKS53aWR0aCArIHRoaXMuX3RpbWVsaW5lLmdldEJvdW5kcygpLnggLSB0aGlzLndpZHRoO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgbWF4RW5kUGxheVRpbWUgPSBNYXRoLm1heC5hcHBseShNYXRoLCB0aGlzLl9hbmltYXRvcnNHcm91cC5tYXAoZGlzcGxheU9iamVjdCA9PiB7cmV0dXJuIGRpc3BsYXlPYmplY3QuYW5pbWF0aW9uLmVuZFBsYXlUaW1lfSkpO1xuXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2VuZFRpbWUgPSBNYXRoLm1heChsZW5ndGgsIG1heEVuZFBsYXlUaW1lKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyDlrprkuYnlvZPliY3ml7bpl7TngrlcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fYWN0aXZlVGltZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fYWN0aXZlVGltZSA8IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2FjdGl2ZVRpbWUgPSAwO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuX2FjdGl2ZVRpbWUgPiB0aGlzLl9lbmRUaW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9hY3RpdmVUaW1lID0gdGhpcy5fZW5kVGltZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGxldCBhY3RpdmVUaW1lID0gLXRoaXMuX2FjdGl2ZVRpbWU7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2lzVmVydGljYWwgPyB0aGlzLl90aW1lbGluZS55ID0gYWN0aXZlVGltZSA6IHRoaXMuX3RpbWVsaW5lLnggPSBhY3RpdmVUaW1lO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl91cGRhdGVBbmltYXRvcnMoKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aGlzLl9zdGFnZS51cGRhdGUoKTtcblxuICAgICAgICAgICAgICAgIC8vIOaYr+WQpuaJk+WNsCBGUFMg54q25oCB77yM5L6d6LWWIHN0YXRlLmpzXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2lzU3RhdGUpIHRoaXMuX3N0YXRzKCk7XG5cbiAgICAgICAgICAgICAgICAvLyDliJ3lp4vljJbmiJDlip/nmoTlm57osINcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5vbkluaXQpIHRoaXMub25Jbml0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNyZWF0ZWpzLlRpY2tlci50aW1pbmdNb2RlID0gY3JlYXRlanMuVGlja2VyLlJBRjtcbiAgICB9XG5cbiAgICAvLyDlkK/liqjlrp7kvotcbiAgICBwbGF5KCkge1xuICAgICAgICBpZiAodGhpcy5fdGlja0V2ZW50KSB0aGlzLnN0b3AoKTtcblxuICAgICAgICB0aGlzLl90aWNrRXZlbnQgPSAoKSA9PiB0aGlzLl9vblRpY2soKTtcblxuICAgICAgICBjcmVhdGVqcy5UaWNrZXIuYWRkRXZlbnRMaXN0ZW5lcigndGljaycsIHRoaXMuX3RpY2tFdmVudCk7XG4gICAgfVxuXG4gICAgLy8g6YeN5paw5byA5aeLXG4gICAgcmVwbGF5KCkge1xuICAgICAgICB0aGlzLl90b3VjaERhdGEudG91Y2hzdGFydCA9IDA7XG4gICAgICAgIHRoaXMuX3RvdWNoRGF0YS50b3VjaG1vdmUgPSAwO1xuICAgICAgICB0aGlzLl90b3VjaERhdGEuaXNJbmVydGFuY2UgPSBmYWxzZTtcblxuICAgICAgICBpZiAodGhpcy5faXNWZXJ0aWNhbCkge1xuICAgICAgICAgICAgdGhpcy5fdGltZWxpbmUueSA9IDA7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl90aW1lbGluZS54ID0gMDtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuX2FuaW1hdG9yc0dyb3VwLmZvckVhY2goKGRpc3BsYXlPYmplY3QpID0+IHtcbiAgICAgICAgICAgIGRpc3BsYXlPYmplY3QuYW5pbWF0aW9uLnNldCgwKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5fc3RhZ2UudXBkYXRlKCk7XG5cbiAgICAgICAgdGhpcy5wbGF5KCk7XG4gICAgfVxuXG4gICAgLy8g5YGc5q2i5a6e5L6LXG4gICAgc3RvcCgpIHtcbiAgICAgICAgY3JlYXRlanMuVGlja2VyLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RpY2snLCB0aGlzLl90aWNrRXZlbnQpO1xuICAgICAgICB0aGlzLl90aWNrRXZlbnQgPSBudWxsO1xuICAgIH1cblxuICAgIC8vIOWIoOmZpCBpZCDmlbDmja7vvIzljIXmi6wgaWQg55qE5a2Q5bGe5oCnXG4gICAgcmVtb3ZlKGlkKSB7XG4gICAgICAgIGxldCBkaXNwbGF5T2JqZWN0ID0gdGhpcy5fb2JqZWN0c1tpZF07XG4gICAgICAgIGxldCBwYXJlbnQgPSBkaXNwbGF5T2JqZWN0LnBhcmVudDtcblxuICAgICAgICBwYXJlbnQucmVtb3ZlQ2hpbGQoZGlzcGxheU9iamVjdCk7XG5cbiAgICAgICAgdGhpcy5fc3RhZ2UudXBkYXRlKCk7XG4gICAgICAgIHRoaXMuX3JlbW92ZU9iamVjdChpZCk7XG4gICAgfVxuXG4gICAgLy8g5pGn5q+B5a+56LGh77yM56e76Zmk5omA5pyJIERhdGEg5a+56LGhXG4gICAgZGVzdHJveSgpIHtcbiAgICAgICAgdGhpcy5zdG9wKCk7XG5cbiAgICAgICAgdGhpcy5faW5pdFRvdWNoRGF0YSgpO1xuXG4gICAgICAgIHRoaXMuX3N0YWdlLnJlbW92ZUFsbENoaWxkcmVuKCk7XG4gICAgICAgIHRoaXMuX3N0YWdlLnVwZGF0ZSgpO1xuXG4gICAgICAgIHRoaXMuX29iamVjdHMgPSB7fTtcbiAgICAgICAgdGhpcy5fYW5pbWF0b3JzR3JvdXAgPSBbXTtcbiAgICAgICAgdGhpcy5fZW5kVGltZSA9IDA7XG4gICAgICAgIHRoaXMuX2FjdGl2ZVRpbWUgPSAwO1xuICAgIH1cblxuICAgIC8vIOiOt+WPluW9k+WJjeaXtumXtOS9jee9rlxuICAgIGdldEFjdGl2ZVRpbWUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9hY3RpdmVUaW1lO1xuICAgIH1cblxuICAgIC8vIOiOt+WPluaAu+aXtumXtFxuICAgIGdldEVuZFRpbWUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9lbmRUaW1lO1xuICAgIH1cblxuICAgIC8vIOiOt+WPliBEYXRhIOWvueixoeS/oeaBr1xuICAgIGdldE9iamVjdChpZCA9ICcnKSB7XG5cbiAgICAgICAgaWYgKGlkID09PSAnJykgcmV0dXJuIHRoaXMuX29iamVjdHM7XG5cbiAgICAgICAgbGV0IGRpc3BsYXlPYmplY3QgPSB0aGlzLl9vYmplY3RzW2lkXTtcblxuICAgICAgICBpZiAoZGlzcGxheU9iamVjdCA9PT0gdW5kZWZpbmVkKSByZXR1cm4gbnVsbDtcblxuICAgICAgICBsZXQge3dpZHRoLCBoZWlnaHQsIHJlZ1gsIHJlZ1ksIHJvdGF0aW9uLCBzY2FsZVgsIHNjYWxlWSwgc2tld1gsIHNrZXdZLCBhbHBoYSwgdHlwZSwgeCwgeSwgdmlzaWJsZX0gPSBkaXNwbGF5T2JqZWN0O1xuICAgICAgICBsZXQgb2JqZWN0ID0ge1xuICAgICAgICAgICAgaWQsXG4gICAgICAgICAgICB3aWR0aCxcbiAgICAgICAgICAgIGhlaWdodCxcbiAgICAgICAgICAgIHJlZ1gsXG4gICAgICAgICAgICByZWdZLFxuICAgICAgICAgICAgcm90YXRpb24sXG4gICAgICAgICAgICBzY2FsZVgsXG4gICAgICAgICAgICBzY2FsZVksXG4gICAgICAgICAgICBza2V3WCxcbiAgICAgICAgICAgIHNrZXdZLFxuICAgICAgICAgICAgYWxwaGEsXG4gICAgICAgICAgICB0eXBlLFxuICAgICAgICAgICAgeCxcbiAgICAgICAgICAgIHksXG4gICAgICAgICAgICB2aXNpYmxlLFxuICAgICAgICAgICAgdGFyZ2V0OiBkaXNwbGF5T2JqZWN0XG4gICAgICAgIH07XG5cbiAgICAgICAgaWYgKHRoaXMuX2lzVmVydGljYWwpIHtcbiAgICAgICAgICAgIG9iamVjdC55ID0gdGhpcy5fZ2V0T2JqZWN0VGltZShkaXNwbGF5T2JqZWN0KVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgb2JqZWN0LnggPSB0aGlzLl9nZXRPYmplY3RUaW1lKGRpc3BsYXlPYmplY3QpXG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZGlzcGxheU9iamVjdC5hbmltYXRpb24pIHtcbiAgICAgICAgICAgIG9iamVjdC5hbmltYXRpb24gPSBkaXNwbGF5T2JqZWN0LmFuaW1hdGlvbjtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBvYmplY3Q7XG4gICAgfVxuXG4gICAgLy8g6I635Y+W5Zu+54mH6LWE5rqQ5L+h5oGvXG4gICAgZ2V0SW1hZ2UoaWQgPSAnJykge1xuXG4gICAgICAgIGlmIChpZCA9PT0gJycpIHJldHVybiB0aGlzLl9sb2FkUXVldWU7XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuX2xvYWRRdWV1ZVtpZF07XG4gICAgfVxuXG4gICAgZ2V0U3ByaXRlKGlkID0gJycpIHtcblxuICAgICAgICBpZiAoaWQgPT09ICcnKSByZXR1cm4gdGhpcy5fc3ByaXRlcztcblxuICAgICAgICByZXR1cm4gdGhpcy5fc3ByaXRlc1tpZF07XG4gICAgfVxuXG4gICAgdGltZVRvKHRpbWUsIGR1cmF0aW9uID0gMCwgY2FsbGJhY2spIHtcblxuICAgICAgICBsZXQgdGltZVRvUG9zID0gMDtcblxuICAgICAgICBpZiAodHlwZW9mKHRpbWUpID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgbGV0IHByZWZpeCA9IHRpbWVbMF07XG4gICAgICAgICAgICBzd2l0Y2ggKHByZWZpeCkge1xuICAgICAgICAgICAgICAgIGNhc2UgJysnOlxuICAgICAgICAgICAgICAgIGNhc2UgJy0nOlxuICAgICAgICAgICAgICAgICAgICB0aW1lVG9Qb3MgPSB0aGlzLl9hY3RpdmVUaW1lICsgcGFyc2VJbnQodGltZSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIC8vIHRpbWVUb1BvcyA9IHRoaXMuX2dldE9iamVjdFRpbWUodGhpcy5fb2JqZWN0c1t0aW1lXSlcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZih0aW1lKSA9PT0gJ251bWJlcicpIHtcbiAgICAgICAgICAgIHRpbWVUb1BvcyA9IHRpbWU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm5cbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLl9hY3RpdmVUaW1lID09PSB0aW1lVG9Qb3MpIHJldHVybjtcblxuICAgICAgICBpZiAodGhpcy5vblRpbWVUb1N0YXJ0KSB0aGlzLm9uVGltZVRvU3RhcnQodGhpcyk7XG5cbiAgICAgICAgaWYgKGR1cmF0aW9uID09PSAwKSB7XG5cbiAgICAgICAgICAgIHRoaXMuX2FjdGl2ZVRpbWUgPSB0aW1lVG9Qb3M7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLl9pc1ZlcnRpY2FsKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fdGltZWxpbmUueSA9IC10aGlzLl9hY3RpdmVUaW1lO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLl90aW1lbGluZS54ID0gLXRoaXMuX2FjdGl2ZVRpbWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuX3VwZGF0ZUFuaW1hdG9ycygpO1xuXG4gICAgICAgICAgICB0aGlzLl9zdGFnZS51cGRhdGUoKTtcblxuICAgICAgICAgICAgdGhpcy5fb25UaW1lVG9FbmQoY2FsbGJhY2spO1xuXG4gICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgIHRoaXMuc3RvcCgpO1xuXG4gICAgICAgICAgICBsZXQgc3RhcnREYXRlID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7XG4gICAgICAgICAgICBsZXQgYWN0aXZlRGF0ZSA9IDA7XG4gICAgICAgICAgICBsZXQgdGltZVRvRGlyID0gMTtcbiAgICAgICAgICAgIGxldCB0aW1lVG9TdGFydCA9IDA7XG4gICAgICAgICAgICBsZXQgdGltZVRvTW92ZSA9IDA7XG4gICAgICAgICAgICBsZXQgdGltZVRvUHJvZ3Jlc3MgPSAwO1xuICAgICAgICAgICAgbGV0IHRpbWVUb0Rpc3RhbmNlID0gTWF0aC5hYnModGhpcy5fYWN0aXZlVGltZSAtIHRpbWVUb1Bvcyk7XG5cbiAgICAgICAgICAgIC8vIOWIpOaWrea7keWKqOaWueWQkVxuICAgICAgICAgICAgaWYgKHRoaXMuX2FjdGl2ZVRpbWUgPiB0aW1lVG9Qb3MpIHRpbWVUb0RpciA9IC0xO1xuXG4gICAgICAgICAgICAvLyDlrprkuYnmu5HliqggVGlja2VyIOS6i+S7tlxuICAgICAgICAgICAgdGhpcy5fdGlja0V2ZW50ID0gKCkgPT4ge1xuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMub25UaWNrU3RhcnQpIHRoaXMub25UaWNrU3RhcnQodGhpcyk7XG5cbiAgICAgICAgICAgICAgICBhY3RpdmVEYXRlID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7XG4gICAgICAgICAgICAgICAgdGltZVRvUHJvZ3Jlc3MgPSAoYWN0aXZlRGF0ZSAtIHN0YXJ0RGF0ZSkvZHVyYXRpb247XG4gICAgICAgICAgICAgICAgdGltZVRvTW92ZSA9IE1hdGguZmxvb3IodGltZVRvUHJvZ3Jlc3MgKiB0aW1lVG9EaXN0YW5jZSkgKiB0aW1lVG9EaXI7XG5cbiAgICAgICAgICAgICAgICBpZiAodGltZVRvTW92ZSA+IHRpbWVUb0Rpc3RhbmNlKSB0aW1lVG9Nb3ZlID0gdGltZVRvRGlzdGFuY2U7XG5cbiAgICAgICAgICAgICAgICB0aGlzLl9hY3RpdmVUaW1lICs9ICh0aW1lVG9Nb3ZlIC0gdGltZVRvU3RhcnQpO1xuXG4gICAgICAgICAgICAgICAgdGltZVRvU3RhcnQgPSB0aW1lVG9Nb3ZlO1xuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2FjdGl2ZVRpbWUgPCAwKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX2lzVmVydGljYWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2FjdGl2ZVRpbWUgPSAwO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fYWN0aXZlVGltZSA9IDA7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9vblRpbWVUb0VuZChjYWxsYmFjayk7XG5cbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuX2FjdGl2ZVRpbWUgPj0gdGhpcy5fZW5kVGltZSkge1xuXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2FjdGl2ZVRpbWUgPSB0aGlzLl9lbmRUaW1lO1xuXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX29uVGltZVRvRW5kKGNhbGxiYWNrKTtcblxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9pc0VuZCA9IHRydWU7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMub25FbmQpIHRoaXMub25FbmQoKTtcblxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodGltZVRvUHJvZ3Jlc3MgPj0gMSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9vblRpbWVUb0VuZChjYWxsYmFjayk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2lzVmVydGljYWwpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdGltZWxpbmUueSA9IC10aGlzLl9hY3RpdmVUaW1lXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdGltZWxpbmUueCA9IC10aGlzLl9hY3RpdmVUaW1lXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhpcy5fdXBkYXRlQW5pbWF0b3JzKCk7XG5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5vblRpY2tFbmQpIHRoaXMub25UaWNrRW5kKHRoaXMpO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5fc3RhZ2UudXBkYXRlKCk7XG5cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGNyZWF0ZWpzLlRpY2tlci5hZGRFdmVudExpc3RlbmVyKCd0aWNrJywgdGhpcy5fdGlja0V2ZW50KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIF9vblRpbWVUb0VuZChjYWxsYmFjaykge1xuICAgICAgICBpZiAodGhpcy5fdG91Y2hEYXRhLnRvdWNobW92ZSAhPT0gMCkgdGhpcy5faW5pdFRvdWNoRGF0YSgpO1xuICAgICAgICBpZiAodGhpcy5vblRpbWVUb0VuZCkgdGhpcy5vblRpbWVUb0VuZCh0aGlzKTtcbiAgICAgICAgaWYgKGNhbGxiYWNrKSBjYWxsYmFjayh0aGlzKTtcbiAgICAgICAgdGhpcy5wbGF5KCk7XG4gICAgfVxuXG4gICAgX29uVGljaygpIHtcbiAgICAgICAgaWYgKCF0aGlzLl9pc0xvYWRpbmcgJiYgdGhpcy5fdGltZWxpbmUpIHtcblxuICAgICAgICAgICAgaWYgKHRoaXMuYXV0b1VwZGF0ZSAmJiB0aGlzLm9uVGlja1N0YXJ0KSB0aGlzLm9uVGlja1N0YXJ0KHRoaXMpO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5fYXV0b1BsYXkgfHwgdGhpcy5fdG91Y2hEYXRhLmlzTW92aW5nKSB7XG5cbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuYXV0b1VwZGF0ZSAmJiB0aGlzLm9uVGlja1N0YXJ0KSB0aGlzLm9uVGlja1N0YXJ0KHRoaXMpO1xuXG4gICAgICAgICAgICAgICAgbGV0IGFjdGl2ZVRpbWU7XG5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fdG91Y2hEYXRhLmlzTW92aW5nKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8g5aaC5p6c5piv5oOv5oCnXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl90b3VjaERhdGEuaXNJbmVydGFuY2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOaDr+aAp+WHj+mAn1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fdG91Y2hEYXRhLnRvdWNobW92ZSAqPSB0aGlzLl90b3VjaERhdGEuZnJpY3Rpb247XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChNYXRoLmFicyh0aGlzLl90b3VjaERhdGEudG91Y2htb3ZlKSA8PSAxKSB0aGlzLl9pbml0VG91Y2hEYXRhKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIC8vIOagueaNrua7keWKqOeahOS9jee9ruiusOW9leWKqOeUu+aJp+ihjFxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5faXNWZXJ0aWNhbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fdGltZWxpbmUueSArPSB0aGlzLl90b3VjaERhdGEudG91Y2htb3ZlICogdGhpcy5fdG91Y2hEYXRhLnNwZWVkO1xuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZlVGltZSA9IC10aGlzLl90aW1lbGluZS55O1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fdGltZWxpbmUueCArPSB0aGlzLl90b3VjaERhdGEudG91Y2htb3ZlICogdGhpcy5fdG91Y2hEYXRhLnNwZWVkO1xuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZlVGltZSA9IC10aGlzLl90aW1lbGluZS54O1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdXBkYXRlVGltZShhY3RpdmVUaW1lKTtcblxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX2lzVmVydGljYWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3RpbWVsaW5lLnkgLT0gdGhpcy5hdXRvU3BlZWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBhY3RpdmVUaW1lID0gLXRoaXMuX3RpbWVsaW5lLnk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl90aW1lbGluZS54IC09IHRoaXMuYXV0b1NwZWVkO1xuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZlVGltZSA9IC10aGlzLl90aW1lbGluZS54O1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdXBkYXRlVGltZShhY3RpdmVUaW1lKTtcblxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLm9uVGlja0VuZCkgdGhpcy5vblRpY2tFbmQodGhpcyk7XG5cbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuYXV0b1VwZGF0ZSkgdGhpcy5fc3RhZ2UudXBkYXRlKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh0aGlzLmF1dG9VcGRhdGUpIHRoaXMuX3N0YWdlLnVwZGF0ZSgpO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5faXNTdGF0ZSkgdGhpcy5zdGF0cy51cGRhdGUoKTtcblxuICAgICAgICB9XG4gICAgfVxuXG4gICAgX3VwZGF0ZVRpbWUoYWN0aXZlVGltZSkge1xuXG4gICAgICAgIGlmIChhY3RpdmVUaW1lIDwgdGhpcy5fZW5kVGltZSkge1xuICAgICAgICAgICAgdGhpcy5faXNFbmQgPSBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChhY3RpdmVUaW1lIDwgMCkge1xuXG4gICAgICAgICAgICBhY3RpdmVUaW1lID0gMDtcblxuICAgICAgICAgICAgaWYgKHRoaXMuX2lzVmVydGljYWwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl90aW1lbGluZS55ID0gMDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fdGltZWxpbmUueCA9IDA7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfSBlbHNlIGlmIChhY3RpdmVUaW1lID4gdGhpcy5fZW5kVGltZSkge1xuXG4gICAgICAgICAgICBhY3RpdmVUaW1lID0gdGhpcy5fZW5kVGltZTtcblxuICAgICAgICAgICAgaWYgKHRoaXMuX2lzVmVydGljYWwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl90aW1lbGluZS55ID0gLXRoaXMuX2VuZFRpbWU7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuX3RpbWVsaW5lLnggPSAtdGhpcy5fZW5kVGltZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHRoaXMuX2lzRW5kKSByZXR1cm47XG5cbiAgICAgICAgICAgIHRoaXMuX2lzRW5kID0gdHJ1ZTtcblxuICAgICAgICAgICAgaWYgKHRoaXMub25FbmQpIHRoaXMub25FbmQoKTtcblxuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fYWN0aXZlVGltZSA9IGFjdGl2ZVRpbWU7XG5cbiAgICAgICAgdGhpcy5fdXBkYXRlQW5pbWF0b3JzKCk7XG4gICAgfVxuXG4gICAgX3VwZGF0ZUFuaW1hdG9ycygpIHtcbiAgICAgICAgbGV0IHBvcyA9IHRoaXMuX2lzVmVydGljYWw/IC10aGlzLl90aW1lbGluZS55IDogLXRoaXMuX3RpbWVsaW5lLng7XG5cbiAgICAgICAgdGhpcy5fYW5pbWF0b3JzR3JvdXAubWFwKGRpc3BsYXlPYmplY3QgPT4ge1xuICAgICAgICAgICAgbGV0IHN0YXJ0UGxheVRpbWUgPSBkaXNwbGF5T2JqZWN0LmFuaW1hdGlvbi5zdGFydFBsYXlUaW1lO1xuICAgICAgICAgICAgbGV0IGVuZFBsYXlUaW1lICAgPSBkaXNwbGF5T2JqZWN0LmFuaW1hdGlvbi5lbmRQbGF5VGltZTtcblxuICAgICAgICAgICAgaWYgKHBvcyA+PSBzdGFydFBsYXlUaW1lICYmIHBvcyA8IGVuZFBsYXlUaW1lKSB7XG4gICAgICAgICAgICAgICAgZGlzcGxheU9iamVjdC5hbmltYXRpb24udXBkYXRlKE1hdGguYWJzKHBvcyAtIHN0YXJ0UGxheVRpbWUpKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocG9zIDwgc3RhcnRQbGF5VGltZSkge1xuICAgICAgICAgICAgICAgIGRpc3BsYXlPYmplY3QuYW5pbWF0aW9uLnNldCgwKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocG9zID49IGVuZFBsYXlUaW1lKSB7XG4gICAgICAgICAgICAgICAgZGlzcGxheU9iamVjdC5hbmltYXRpb24uc2V0KGVuZFBsYXlUaW1lIC0gc3RhcnRQbGF5VGltZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmICh0aGlzLm9uVGlja0VuZCkgdGhpcy5vblRpY2tFbmQodGhpcyk7XG4gICAgfVxuXG4gICAgX3ByZWxvYWQobWFuaWZlc3QgPSBbXSwgeyBvbkNvbXBsZXRlID0gKCkgPT4ge30sIG9uUHJvZ3Jlc3MgPSAoKSA9PiB7fSwgcGF0aCA9ICcnfSA9IHt9KSB7XG5cbiAgICAgICAgdGhpcy5faXNMb2FkaW5nID0gdHJ1ZTtcblxuICAgICAgICBsZXQgZmlsZUxpc3QgPSBudWxsO1xuXG4gICAgICAgIGlmIChBcnJheS5pc0FycmF5KG1hbmlmZXN0KSkge1xuICAgICAgICAgICAgaWYgKG1hbmlmZXN0Lmxlbmd0aCA9PT0gMCkgcmV0dXJuO1xuICAgICAgICAgICAgZmlsZUxpc3QgPSBtYW5pZmVzdDtcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YobWFuaWZlc3QpID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgZmlsZUxpc3QgPSBbXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBzcmM6IG1hbmlmZXN0LFxuICAgICAgICAgICAgICAgICAgICBpZDogbWFuaWZlc3RcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICBdO1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZihtYW5pZmVzdCkgPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICBpZiAoIW1hbmlmZXN0LmlkKSB7XG4gICAgICAgICAgICAgICAgbWFuaWZlc3QuaWQgPSBtYW5pZmVzdC5zcmM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmaWxlTGlzdCA9IFttYW5pZmVzdF07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgbG9hZGVkTnVtYmVyID0gMDtcbiAgICAgICAgbGV0IHByZWxvYWROdW1iZXIgPSBmaWxlTGlzdC5sZW5ndGg7XG4gICAgICAgIGxldCBpbWFnZXMgPSB7fTtcblxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHByZWxvYWROdW1iZXI7IGkrKykge1xuICAgICAgICAgICAgbGV0IGltYWdlID0gbmV3IEltYWdlKCk7XG4gICAgICAgICAgICBsZXQgZmlsZSA9IGZpbGVMaXN0W2ldO1xuICAgICAgICAgICAgbGV0IGZpbGVUeXBlID0gdHlwZW9mKGZpbGUpO1xuICAgICAgICAgICAgbGV0IHNyYyA9ICcnO1xuXG4gICAgICAgICAgICBpZiAoZmlsZVR5cGUgPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICAgICAgc3JjID0gZmlsZS5zcmM7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGZpbGVUeXBlID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgIHNyYyA9IGZpbGU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGltYWdlLnNyYyA9IHBhdGggKyBzcmM7XG4gICAgICAgICAgICBpbWFnZS5vbmxvYWQgPSAoKSA9PiB7XG5cbiAgICAgICAgICAgICAgICBpZiAoZmlsZS5pZCkge1xuICAgICAgICAgICAgICAgICAgICBpbWFnZXNbZmlsZS5pZF0gPSBpbWFnZTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpbWFnZXNbc3JjXSA9IGltYWdlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGxvYWRlZE51bWJlcisrO1xuXG4gICAgICAgICAgICAgICAgbGV0IHByb2dyZXNzID0gTWF0aC5mbG9vcihsb2FkZWROdW1iZXIvcHJlbG9hZE51bWJlciAqIDEwMCk7XG5cbiAgICAgICAgICAgICAgICBvblByb2dyZXNzKHByb2dyZXNzKTtcblxuICAgICAgICAgICAgICAgIGlmIChwcm9ncmVzcyA+PSAxMDApIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5faXNMb2FkaW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2xvYWRRdWV1ZSA9IGltYWdlcztcbiAgICAgICAgICAgICAgICAgICAgb25Db21wbGV0ZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICAvLyDln7rkuo4gUHJlbG9hZEpzXG4gICAgICAgIC8vIHRoaXMuX2xvYWRRdWV1ZSA9IG5ldyBjcmVhdGVqcy5Mb2FkUXVldWUodHJ1ZSwgcGF0aCk7XG4gICAgICAgIC8vXG4gICAgICAgIC8vIGlmIChwcm9ncmVzcykgdGhpcy5fbG9hZFF1ZXVlLm9uKCdwcm9ncmVzcycsIGUgPT4gb25Qcm9ncmVzcyhlKSk7XG4gICAgICAgIC8vXG4gICAgICAgIC8vIHRoaXMuX2xvYWRRdWV1ZS5vbignY29tcGxldGUnLCBlID0+IHtcbiAgICAgICAgLy8gICAgIHRoaXMuX2lzTG9hZGluZyA9IGZhbHNlO1xuICAgICAgICAvLyAgICAgaWYgKG9uQ29tcGxldGUpIG9uQ29tcGxldGUoZSk7XG4gICAgICAgIC8vIH0pO1xuICAgICAgICAvL1xuICAgICAgICAvLyB0aGlzLl9sb2FkUXVldWUubG9hZE1hbmlmZXN0KGxvYWRNYW5pZmVzdCk7XG4gICAgfVxuXG4gICAgX2FkZE9iamVjdChvYmogPSB7fSkge1xuXG4gICAgICAgIGxldCBkaXNwbGF5T2JqZWN0ID0gbnVsbDtcblxuICAgICAgICBzd2l0Y2ggKG9iai50eXBlKSB7XG4gICAgICAgICAgICBjYXNlICdzaGFwZSc6XG5cbiAgICAgICAgICAgICAgICBkaXNwbGF5T2JqZWN0ID0gbmV3IGNyZWF0ZWpzLlNoYXBlKCk7XG5cbiAgICAgICAgICAgICAgICBmb3IgKGxldCBrZXkgb2YgT2JqZWN0LmtleXMob2JqLmdyYXBoaWNzKSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShvYmouZ3JhcGhpY3Nba2V5XSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXlPYmplY3QuZ3JhcGhpY3Nba2V5XSguLi5vYmouZ3JhcGhpY3Nba2V5XSlcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChvYmouZ3JhcGhpY3Nba2V5XSBpbnN0YW5jZW9mIE9iamVjdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheU9iamVjdC5ncmFwaGljc1trZXldKG9iai5ncmFwaGljc1trZXldKVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheU9iamVjdC5ncmFwaGljc1trZXldKG9iai5ncmFwaGljc1trZXldKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnYml0bWFwJzpcbiAgICAgICAgICAgICAgICBpZiAob2JqLmltYWdlKSB7XG4gICAgICAgICAgICAgICAgICAgIGRpc3BsYXlPYmplY3QgPSBuZXcgY3JlYXRlanMuQml0bWFwKG9iai5pbWFnZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAndGV4dCc6XG4gICAgICAgICAgICAgICAgZGlzcGxheU9iamVjdCA9IG5ldyBjcmVhdGVqcy5UZXh0KCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdzcHJpdGUnOlxuICAgICAgICAgICAgICAgIGlmIChvYmouc2hlZXQpIHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IHNwcml0ZVNoZWV0ID0gbmV3IGNyZWF0ZWpzLlNwcml0ZVNoZWV0KG9iai5zaGVldCk7XG4gICAgICAgICAgICAgICAgICAgIGRpc3BsYXlPYmplY3QgPSBuZXcgY3JlYXRlanMuU3ByaXRlKHNwcml0ZVNoZWV0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIGRpc3BsYXlPYmplY3QgPSBuZXcgY3JlYXRlanMuQ29udGFpbmVyKCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAob2JqLnR5cGUpIHtcbiAgICAgICAgICAgIGRpc3BsYXlPYmplY3QudHlwZSA9IG9iai50eXBlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZGlzcGxheU9iamVjdC50eXBlID0gJ2NvbnRhaW5lcic7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAob2JqLmlkKSBkaXNwbGF5T2JqZWN0Lm5hbWUgPSBvYmouaWQ7XG5cbiAgICAgICAgaWYgKG9iai5wYXJlbnRfaWQpIGRpc3BsYXlPYmplY3QucGFyZW50SWQgPSBvYmoucGFyZW50X2lkO1xuXG4gICAgICAgIGlmIChvYmoucHJvcCkge1xuICAgICAgICAgICAgZm9yIChsZXQgcHJvcEtleSBvZiBPYmplY3Qua2V5cyhvYmoucHJvcCkpIHtcbiAgICAgICAgICAgICAgICAvLyDliKTmlq3lsZ7mgKfnsbvlnotcbiAgICAgICAgICAgICAgICBpZiAoZGlzcGxheU9iamVjdFtwcm9wS2V5XSBpbnN0YW5jZW9mIE9iamVjdCkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBrZXkgb2YgT2JqZWN0LmtleXMob2JqLnByb3BbcHJvcEtleV0pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGRpc3BsYXlPYmplY3RbcHJvcEtleV1ba2V5XSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXlPYmplY3RbcHJvcEtleV1ba2V5XSguLi5vYmoucHJvcFtwcm9wS2V5XVtrZXldKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheU9iamVjdFtwcm9wS2V5XVtrZXldID0gb2JqLnByb3BbcHJvcEtleV1ba2V5XTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGRpc3BsYXlPYmplY3RbcHJvcEtleV0gPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICAgICAgZGlzcGxheU9iamVjdFtwcm9wS2V5XSguLi5vYmoucHJvcFtwcm9wS2V5XSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZGlzcGxheU9iamVjdFtwcm9wS2V5XSA9IG9iai5wcm9wW3Byb3BLZXldO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKG9iai50eXBlID09PSAndGV4dCcgJiYgb2JqLnByb3AuYWxpZ24pIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKG9iai5wcm9wLmFsaWduKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2NlbnRlcic6XG4gICAgICAgICAgICAgICAgICAgICAgICBkaXNwbGF5T2JqZWN0LnggPSAodGhpcy53aWR0aCAtIGRpc3BsYXlPYmplY3QuZ2V0Qm91bmRzKCkud2lkdGgpLzI7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAncmlnaHQnOlxuICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheU9iamVjdC54ID0gdGhpcy53aWR0aCAtIGRpc3BsYXlPYmplY3QuZ2V0Qm91bmRzKCkud2lkdGg7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXlPYmplY3QueCA9IDA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKG9iai5tZXRob2QpIHtcbiAgICAgICAgICAgIGZvciAobGV0IGtleSBvZiBPYmplY3Qua2V5cyhvYmoubWV0aG9kKSkge1xuICAgICAgICAgICAgICAgIGRpc3BsYXlPYmplY3Rba2V5XSguLi5vYmoubWV0aG9kW2tleV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKG9iai5ldmVudCkge1xuICAgICAgICAgICAgaWYgKG9iai5ldmVudC5oYW5kbGUpIHtcbiAgICAgICAgICAgICAgICBsZXQgdHlwZSA9IG9iai5ldmVudC50eXBlIHx8ICdjbGljayc7XG4gICAgICAgICAgICAgICAgZGlzcGxheU9iamVjdC5hZGRFdmVudExpc3RlbmVyKHR5cGUsIG9iai5ldmVudC5oYW5kbGUpXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZGlzcGxheU9iamVjdC5nZXRCb3VuZHMoKSkge1xuICAgICAgICAgICAgbGV0IGJvdW5kcyA9IGRpc3BsYXlPYmplY3QuZ2V0Qm91bmRzKCk7XG4gICAgICAgICAgICBkaXNwbGF5T2JqZWN0LndpZHRoID0gYm91bmRzLndpZHRoO1xuICAgICAgICAgICAgZGlzcGxheU9iamVjdC5oZWlnaHQgPSBib3VuZHMuaGVpZ2h0O1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGRpc3BsYXlPYmplY3Q7XG5cbiAgICB9XG5cbiAgICBfcmVtb3ZlT2JqZWN0KGlkKSB7XG4gICAgICAgIGxldCBkaXNwbGF5T2JqZWN0ID0gdGhpcy5fb2JqZWN0c1tpZF07XG5cbiAgICAgICAgZGVsZXRlIHRoaXMuX29iamVjdHNbaWRdO1xuXG4gICAgICAgIGlmIChkaXNwbGF5T2JqZWN0LmFuaW1hdGlvbikge1xuICAgICAgICAgICAgdGhpcy5fcmVtb3ZlQW5pbWF0b3IoZGlzcGxheU9iamVjdC5uYW1lKVxuICAgICAgICB9XG5cbiAgICAgICAgbGV0IGNoaWxkcmVuID0gZGlzcGxheU9iamVjdC5jaGlsZHJlbjtcblxuICAgICAgICBpZiAoY2hpbGRyZW4pIHtcbiAgICAgICAgICAgIGNoaWxkcmVuLmZvckVhY2goY2hpbGQgPT4ge1xuICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLl9vYmplY3RzW2NoaWxkLm5hbWVdO1xuICAgICAgICAgICAgICAgIGlmIChjaGlsZC5jaGlsZHJlbikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZW1vdmVPYmplY3QoY2hpbGQpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChjaGlsZC5hbmltYXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVtb3ZlQW5pbWF0b3IoY2hpbGQubmFtZSlcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgX3JlbW92ZUFuaW1hdG9yKGlkKSB7XG4gICAgICAgIGZvcihsZXQgaSA9IDAsIGxlbiA9IHRoaXMuX2FuaW1hdG9yc0dyb3VwLmxlbmd0aDsgaSA8IGxlbjsgaSsrICl7XG4gICAgICAgICAgICBpZiAodGhpcy5fYW5pbWF0b3JzR3JvdXBbaV0ubmFtZSA9PT0gaWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9hbmltYXRvcnNHcm91cC5zcGxpY2UoaSwgMSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgX3JlbmRlcihkYXRhID0gW10sIHBhcmVudF9pZCwgY3VzdG9tID0gKCkgPT4ge30pIHtcblxuICAgICAgICBpZiAoZGF0YSBpbnN0YW5jZW9mIE9iamVjdCkge1xuICAgICAgICAgICAgZGF0YSA9IEFycmF5LmZyb20oZGF0YSlcbiAgICAgICAgfVxuXG4gICAgICAgIGRhdGEubWFwKChvYmosIGluZGV4KSA9PiB7XG5cbiAgICAgICAgICAgIG9iai5wYXJlbnRfaWQgPSBwYXJlbnRfaWQ7XG5cbiAgICAgICAgICAgIGlmIChvYmouaWQgPT09IHVuZGVmaW5lZCkgb2JqLmlkID0gYCR7cGFyZW50X2lkfV8ke2luZGV4fWA7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLl9vYmplY3RzW29iai5pZF0pIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGBEYXRhIGlkOicke29iai5pZH0nIGlzIGl0IGV4aXN0cyBhbHJlYWR5YCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLl9vYmplY3RzW29iai5pZF0gPSB0aGlzLl9hZGRPYmplY3Qob2JqKTtcblxuICAgICAgICAgICAgaWYgKHRoaXMuX2lzTG9nKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5ncm91cChvYmouaWQgKyAnOicpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUudGFibGUoe1xuICAgICAgICAgICAgICAgICAgICB4IDogdGhpcy5fb2JqZWN0c1tvYmouaWRdLngsXG4gICAgICAgICAgICAgICAgICAgIHkgOiB0aGlzLl9vYmplY3RzW29iai5pZF0ueSxcbiAgICAgICAgICAgICAgICAgICAgcmVnWCA6IHRoaXMuX29iamVjdHNbb2JqLmlkXS5yZWdYLFxuICAgICAgICAgICAgICAgICAgICByZWdZIDogdGhpcy5fb2JqZWN0c1tvYmouaWRdLnJlZ1ksXG4gICAgICAgICAgICAgICAgICAgIHNjYWxlWCA6IHRoaXMuX29iamVjdHNbb2JqLmlkXS5zY2FsZVgsXG4gICAgICAgICAgICAgICAgICAgIHNjYWxlWSA6IHRoaXMuX29iamVjdHNbb2JqLmlkXS5zY2FsZVksXG4gICAgICAgICAgICAgICAgICAgIHJvdGF0aW9uIDogdGhpcy5fb2JqZWN0c1tvYmouaWRdLnJvdGF0aW9uLFxuICAgICAgICAgICAgICAgICAgICBhbHBoYSA6IHRoaXMuX29iamVjdHNbb2JqLmlkXS5hbHBoYSxcbiAgICAgICAgICAgICAgICAgICAgdmlzaWJsZSA6IHRoaXMuX29iamVjdHNbb2JqLmlkXS52aXNpYmxlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChwYXJlbnRfaWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9vYmplY3RzW3BhcmVudF9pZF0uYWRkQ2hpbGQodGhpcy5fb2JqZWN0c1tvYmouaWRdKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fc3RhZ2UuYWRkQ2hpbGQodGhpcy5fb2JqZWN0c1tvYmouaWRdKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8g6Ieq5a6a5LmJ5bGe5oCnXG4gICAgICAgICAgICBpZiAoY3VzdG9tKSB7XG4gICAgICAgICAgICAgICAgY3VzdG9tKHRoaXMuX29iamVjdHNbb2JqLmlkXSwgb2JqKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKG9iai5jaGlsZHJlbikge1xuICAgICAgICAgICAgICAgIHRoaXMuX3JlbmRlcihvYmouY2hpbGRyZW4sIG9iai5pZCwgY3VzdG9tKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHRoaXMuX2lzTG9nKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5ncm91cEVuZCgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuX3N0YWdlLnVwZGF0ZSgpO1xuICAgIH1cblxuICAgIF9jcmVhdGVBbmltYXRlKGRpc3BsYXlPYmplY3QsIHtcbiAgICAgICAgeCA9IG51bGwsXG4gICAgICAgIHkgPSBudWxsLFxuICAgICAgICBzY2FsZVggPSBudWxsLFxuICAgICAgICBzY2FsZVkgPSBudWxsLFxuICAgICAgICBza2V3WCA9IG51bGwsXG4gICAgICAgIHNrZXdZID0gbnVsbCxcbiAgICAgICAgcm90YXRpb24gPSBudWxsLFxuICAgICAgICBhbHBoYSA9IDEsXG4gICAgICAgIHRvcCA9IDAsXG4gICAgICAgIGRlbGF5ID0gMCxcbiAgICAgICAgZHVyYXRpb24gPSAwLFxuICAgICAgICBzcHJpdGUgPSBbXSxcbiAgICAgICAgc3RhcnRCeUlkID0gbnVsbCxcbiAgICAgICAgZW5kQnlJZCA9IG51bGwsXG4gICAgICAgIGFmdGVyQnlJZCA9IG51bGwsXG4gICAgICAgIG11c2ljQnlJZCA9IG51bGwsXG4gICAgICAgIG11c2ljU3RvcEJ5SWQgPSBudWxsLFxuICAgIH0gPSB7fSkge1xuICAgICAgICBsZXQgbWFwUG9zID0gdGhpcy5fZ2V0T2JqZWN0VGltZShkaXNwbGF5T2JqZWN0KSArIHRoaXMuX2RlbGF5VGltZSxcbiAgICAgICAgICAgIHN0YXJ0WCA9IGRpc3BsYXlPYmplY3QueCwgICAgICAgICAgICAgICAgICAgIC8vIOWKqOeUuyBYIOW8gOWni1xuICAgICAgICAgICAgc3RhcnRZID0gZGlzcGxheU9iamVjdC55LCAgICAgICAgICAgICAgICAgICAgLy8g5Yqo55S7IFkg5byA5aeLXG4gICAgICAgICAgICBlbmRYID0geCwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDliqjnlLsgWCDnu5PmnZ9cbiAgICAgICAgICAgIGVuZFkgPSB5LCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOWKqOeUuyBZIOe7k+adn1xuICAgICAgICAgICAgaW5pdEFscGhhID0gZGlzcGxheU9iamVjdC5hbHBoYSxcbiAgICAgICAgICAgIGluaXRTY2FsZVggPSBkaXNwbGF5T2JqZWN0LnNjYWxlWCxcbiAgICAgICAgICAgIGluaXRTY2FsZVkgPSBkaXNwbGF5T2JqZWN0LnNjYWxlWSxcbiAgICAgICAgICAgIGluaXRTa2V3WCA9IGRpc3BsYXlPYmplY3Quc2tld1gsXG4gICAgICAgICAgICBpbml0U2tld1kgPSBkaXNwbGF5T2JqZWN0LnNrZXdZLFxuICAgICAgICAgICAgaW5pdFJvdGF0aW9uID0gZGlzcGxheU9iamVjdC5yb3RhdGlvbixcbiAgICAgICAgICAgIGlzTXVzaWMgPSBmYWxzZSxcbiAgICAgICAgICAgIGlzUGxheSA9IGZhbHNlLFxuICAgICAgICAgICAgbXVzaWMgPSBudWxsLFxuICAgICAgICAgICAgbXVzaWNTdG9wID0gbnVsbDtcblxuICAgICAgICBsZXQgc3RhcnRQbGF5VGltZSA9IDA7ICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDlr7nosaHlvIDlp4vmiafooYzliqjnlLvkvY3nva5cbiAgICAgICAgbGV0IGVuZFBsYXlUaW1lID0gMDsgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g5a+56LGh57uT5p2f5omn6KGM5Yqo55S75L2N572uXG5cbiAgICAgICAgaWYgKHRvcCkge1xuICAgICAgICAgICAgZGVsYXkgPSAtdG9wO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHN0YXJ0QnlJZCkge1xuICAgICAgICAgICAgc3RhcnRQbGF5VGltZSA9IHRoaXMuX29iamVjdHNbc3RhcnRCeUlkXS5hbmltYXRpb24uc3RhcnRQbGF5VGltZSArIGRlbGF5O1xuICAgICAgICB9IGVsc2UgaWYgKGFmdGVyQnlJZCkge1xuICAgICAgICAgICAgc3RhcnRQbGF5VGltZSA9IHRoaXMuX29iamVjdHNbYWZ0ZXJCeUlkXS5hbmltYXRpb24uZW5kUGxheVRpbWUgKyBkZWxheTtcbiAgICAgICAgfSBlbHNlIGlmIChlbmRCeUlkKSB7XG4gICAgICAgICAgICBzdGFydFBsYXlUaW1lID0gdGhpcy5fb2JqZWN0c1tlbmRCeUlkXS5hbmltYXRpb24uZW5kUGxheVRpbWUgLSBkdXJhdGlvbiArIGRlbGF5O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKG1hcFBvcyArIGRlbGF5ID49IHRoaXMucGxheUxpbmUpIHtcbiAgICAgICAgICAgICAgICBzdGFydFBsYXlUaW1lID0gbWFwUG9zICsgZGVsYXkgLSB0aGlzLnBsYXlMaW5lO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBzdGFydFBsYXlUaW1lID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChlbmRCeUlkKSB7XG4gICAgICAgICAgICBlbmRQbGF5VGltZSA9IHRoaXMuX29iamVjdHNbZW5kQnlJZF0uYW5pbWF0aW9uLmVuZFBsYXlUaW1lO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZW5kUGxheVRpbWUgPSBzdGFydFBsYXlUaW1lICsgZHVyYXRpb247XG4gICAgICAgIH1cblxuICAgICAgICBpZiAobXVzaWNCeUlkKSB7XG4gICAgICAgICAgICBtdXNpYyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKG11c2ljQnlJZCk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAobXVzaWNTdG9wQnlJZCkge1xuICAgICAgICAgICAgbXVzaWNTdG9wID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQobXVzaWNTdG9wQnlJZCk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBfYW5pbWF0ZShyYXRlKSB7XG4gICAgICAgICAgICBsZXQgcHJvZ3Jlc3MgPSByYXRlL2R1cmF0aW9uO1xuXG4gICAgICAgICAgICBpZiAoc3ByaXRlLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgICAgICBsZXQgbGVuZ3RoID0gc3ByaXRlLmxlbmd0aDtcbiAgICAgICAgICAgICAgICBsZXQgZHVyYXRpb25TZWdtZW50ID0gZHVyYXRpb24vbGVuZ3RoO1xuICAgICAgICAgICAgICAgIGxldCBjdXJyZW50SW5kZXggPSBNYXRoLm1pbihyYXRlL2R1cmF0aW9uU2VnbWVudCB8IDAsIGxlbmd0aCAtIDEpO1xuICAgICAgICAgICAgICAgIGRpc3BsYXlPYmplY3QuaW1hZ2UgPSBzcHJpdGVbY3VycmVudEluZGV4XTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYoZW5kWCB8fCBlbmRYID09PSAwKSBkaXNwbGF5T2JqZWN0LnggPSBwcm9ncmVzcyAqIChlbmRYIC0gc3RhcnRYKSArIHN0YXJ0WDtcbiAgICAgICAgICAgIGlmKGVuZFkgfHwgZW5kWSA9PT0gMCkgZGlzcGxheU9iamVjdC55ID0gcHJvZ3Jlc3MgKiAgKGVuZFkgLSBzdGFydFkpICsgc3RhcnRZO1xuICAgICAgICAgICAgaWYoc2NhbGVYIHx8IHNjYWxlWCA9PT0gMCkgZGlzcGxheU9iamVjdC5zY2FsZVggPSBwcm9ncmVzcyAqIChzY2FsZVggLSBpbml0U2NhbGVYKSArIGluaXRTY2FsZVg7XG4gICAgICAgICAgICBpZihzY2FsZVkgfHwgc2NhbGVZID09PSAwKSBkaXNwbGF5T2JqZWN0LnNjYWxlWSA9IHByb2dyZXNzICogKHNjYWxlWSAtIGluaXRTY2FsZVkpICsgaW5pdFNjYWxlWTtcbiAgICAgICAgICAgIGlmKHNrZXdYIHx8IHNrZXdYID09PSAwKSBkaXNwbGF5T2JqZWN0LnNrZXdYID0gcHJvZ3Jlc3MgKiAoc2tld1ggLSBpbml0U2tld1gpICsgaW5pdFNrZXdYO1xuICAgICAgICAgICAgaWYoc2tld1kgfHwgc2tld1kgPT09IDApIGRpc3BsYXlPYmplY3Quc2tld1kgPSBwcm9ncmVzcyAqIChza2V3WSAtIGluaXRTa2V3WSkgKyBpbml0U2tld1k7XG4gICAgICAgICAgICBpZihyb3RhdGlvbiB8fCByb3RhdGlvbiA9PT0gMCkgZGlzcGxheU9iamVjdC5yb3RhdGlvbiA9IHByb2dyZXNzICogKHJvdGF0aW9uIC0gaW5pdFJvdGF0aW9uKSArIGluaXRSb3RhdGlvbjtcbiAgICAgICAgICAgIGlmKGFscGhhIHx8IGFscGhhID09PSAwKSBkaXNwbGF5T2JqZWN0LmFscGhhID0gcHJvZ3Jlc3MgKiAoYWxwaGEgLSBpbml0QWxwaGEpICsgaW5pdEFscGhhO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHN0YXJ0UGxheVRpbWUsXG4gICAgICAgICAgICBlbmRQbGF5VGltZSxcbiAgICAgICAgICAgIHVwZGF0ZShyYXRlKSB7XG5cbiAgICAgICAgICAgICAgICBsZXQgcHJvZ3Jlc3MgPSByYXRlL2R1cmF0aW9uO1xuXG4gICAgICAgICAgICAgICAgaWYgKChwcm9ncmVzcyA9PT0gMCB8fCBwcm9ncmVzcyA9PT0gMSkgJiYgaXNQbGF5ID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHByb2dyZXNzID49IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgcHJvZ3Jlc3MgPSAxO1xuICAgICAgICAgICAgICAgICAgICBpc1BsYXkgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHByb2dyZXNzIDw9IDApIHtcbiAgICAgICAgICAgICAgICAgICAgcHJvZ3Jlc3MgPSAwO1xuICAgICAgICAgICAgICAgICAgICBpc1BsYXkgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpc1BsYXkgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChtdXNpYykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoaXNNdXNpYyA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG11c2ljLmN1cnJlbnRUaW1lID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIG11c2ljLnBsYXkoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzTXVzaWMgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGlzTXVzaWMgPT09IHRydWUgJiYgcHJvZ3Jlc3MgPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghbXVzaWMucGF1c2VkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbXVzaWMucGF1c2UoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc011c2ljID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAobXVzaWNTdG9wKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghbXVzaWNTdG9wLnBhdXNlZCkgbXVzaWNTdG9wLnBhdXNlKCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgX2FuaW1hdGUocmF0ZSlcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzZXQocmF0ZSkge1xuICAgICAgICAgICAgICAgIGlmIChpc1BsYXkpIGlzUGxheSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGlmIChpc011c2ljKSBpc011c2ljID0gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICBfYW5pbWF0ZShyYXRlKVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgX2dldE9iamVjdFRpbWUoZGlzcGxheU9iamVjdCkge1xuICAgICAgICBsZXQgc3VtID0gdGhpcy5faXNWZXJ0aWNhbD8gZGlzcGxheU9iamVjdC55IDogZGlzcGxheU9iamVjdC54O1xuICAgICAgICBsZXQgX3RoaXMgPSB0aGlzO1xuXG4gICAgICAgIF9jb3VudFRpbWUoZGlzcGxheU9iamVjdCk7XG5cbiAgICAgICAgcmV0dXJuIHN1bTtcblxuICAgICAgICBmdW5jdGlvbiBfY291bnRUaW1lKGRpc3BsYXlPYmplY3QpIHtcbiAgICAgICAgICAgIGxldCBwYXJlbnQgPSBkaXNwbGF5T2JqZWN0LnBhcmVudDtcblxuICAgICAgICAgICAgaWYgKHBhcmVudCAmJiBwYXJlbnQubmFtZSAhPT0gJ190aW1lbGluZScpIHtcbiAgICAgICAgICAgICAgICBzdW0gKz0gX3RoaXMuX2lzVmVydGljYWw/IHBhcmVudC55IDogcGFyZW50Lng7XG4gICAgICAgICAgICAgICAgX2NvdW50VGltZShwYXJlbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8g5Yid5aeL5YyW5omL5Yq/XG4gICAgX2luaXRUb3VjaEV2ZW50KCkge1xuICAgICAgICB0aGlzLmNhbnZhcy5hZGRFdmVudExpc3RlbmVyKCd0b3VjaHN0YXJ0JywgKGUpID0+IHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9pc1ZlcnRpY2FsKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fdG91Y2hEYXRhLnRvdWNoc3RhcnQgPSBlLnRvdWNoZXNbMF0uY2xpZW50WTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fdG91Y2hEYXRhLnRvdWNoc3RhcnQgPSBlLnRvdWNoZXNbMF0uY2xpZW50WDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5fdG91Y2hEYXRhLmlzSW5lcnRhbmNlID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLl90b3VjaERhdGEuaXNNb3ZpbmcgPSBmYWxzZTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5jYW52YXMuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2htb3ZlJywgKGUpID0+IHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9pc1ZlcnRpY2FsKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fdG91Y2hEYXRhLnRvdWNobW92ZSA9IGUudG91Y2hlc1swXS5jbGllbnRZIC0gdGhpcy5fdG91Y2hEYXRhLnRvdWNoc3RhcnQ7XG4gICAgICAgICAgICAgICAgdGhpcy5fdG91Y2hEYXRhLnRvdWNoc3RhcnQgPSBlLnRvdWNoZXNbMF0uY2xpZW50WTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fdG91Y2hEYXRhLnRvdWNobW92ZSA9IGUudG91Y2hlc1swXS5jbGllbnRYIC0gdGhpcy5fdG91Y2hEYXRhLnRvdWNoc3RhcnQ7XG4gICAgICAgICAgICAgICAgdGhpcy5fdG91Y2hEYXRhLnRvdWNoc3RhcnQgPSBlLnRvdWNoZXNbMF0uY2xpZW50WDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX3RvdWNoRGF0YS5pc01vdmluZyA9IHRydWU7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kJywgKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5fdG91Y2hEYXRhLmlzSW5lcnRhbmNlID0gdHJ1ZTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgX2luaXRUb3VjaERhdGEoKSB7XG4gICAgICAgIHRoaXMuX3RvdWNoRGF0YS50b3VjaHN0YXJ0ID0gMDtcbiAgICAgICAgdGhpcy5fdG91Y2hEYXRhLnRvdWNobW92ZSA9IDA7XG4gICAgICAgIHRoaXMuX3RvdWNoRGF0YS5pc0luZXJ0YW5jZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLl90b3VjaERhdGEuaXNNb3ZpbmcgPSBmYWxzZTtcbiAgICB9XG5cbiAgICBfc3RhdHMgKCkge1xuICAgICAgICB0aGlzLnN0YXRzID0gbmV3IFN0YXRzKCk7XG4gICAgICAgIHRoaXMuc3RhdHMuc2hvd1BhbmVsKDApOyAvLyAwOiBmcHMsIDE6IG1zLCAyOiBtYiwgMys6IGN1c3RvbVxuICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHRoaXMuc3RhdHMuZG9tKTtcbiAgICB9XG59Il19
